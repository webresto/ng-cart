!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@webresto/ng-core"),require("@angular/common")):"function"==typeof define&&define.amd?define("@webresto/ng-cart",["exports","@angular/core","rxjs","rxjs/operators","@webresto/ng-core","@angular/common"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).webresto=e.webresto||{},e.webresto["ng-cart"]={}),e.ng.core,e.rxjs,e.rxjs.operators,e.i1,e.ng.common)}(this,(function(e,t,n,i,r,o){"use strict";var s=function(){function e(e,t){this.net=e,this.eventer=t,this.cartID=this.getCartId(),this.cart=new n.BehaviorSubject(null),this.modifires=new n.BehaviorSubject([]),this.OrderFormChange=new n.BehaviorSubject(null),this.modifiresMessage=new n.BehaviorSubject([]),this.restrictions$=this.net.get("/restrictions")}return e.prototype.getCartId=function(){return localStorage.getItem("cartID")},e.prototype.getCart=function(){var e=this;return this.net.get("/cart"+(this.cartID?"?cartId="+this.cartID:"")).pipe(i.switchMap((function(t){return t||e.removeCartId(),t?n.from([t]):e.net.get("/cart}")})),i.switchMap((function(t){return"ORDER"==t.cart.state?n.throwError(new Error("Cart in order state")):(e.cartID||e.setCartId(t.cart.cartId),e.cart.next(t.cart),e.cart)})),i.catchError((function(t){return e.removeCartId(),n.throwError(t)})))},e.prototype.addDishToCart=function(e){var t=this;this.modifiresMessage.value.length?this.modifiresMessage.value.forEach((function(e){t.eventer.emitMessageEvent(e)})):this.net.put("/cart/add",e).subscribe((function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId}),(function(){}))},e.prototype.addDishToCart$=function(e){var t=this;return this.modifiresMessage.value.length?(this.modifiresMessage.value.forEach((function(e){t.eventer.emitMessageEvent(e)})),n.from([null])):this.net.put("/cart/add",e).pipe(i.tap((function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId})))},e.prototype.setDishCountToCart=function(e,t){var n=this;this.net.post("/cart/set",{dishId:e,cartId:this.cartID,amount:t}).subscribe((function(e){n.setCartId(e.cart.cartId),n.cart.next(e.cart),n.cartID=e.cart.cartId}),(function(){}))},e.prototype.setDishComment=function(e,t){var n=this;return this.net.post("/cart/setcomment",{dishId:e,cartId:this.cartID,comment:t}).pipe(i.tap((function(e){n.setCartId(e.cart.cartId),n.cart.next(e.cart),n.cartID=e.cart.cartId}),(function(){})))},e.prototype.removeDishFromCart$=function(e,t){var n=this;return this.net.put("/cart/remove",{dishId:e,cartId:this.cartID,amount:t}).pipe(i.tap((function(e){n.setCartId(e.cart.cartId),n.cart.next(e.cart),n.cartID=e.cart.cartId})))},e.prototype.removeDishFromCart=function(e,t){var n=this;this.net.put("/cart/remove",{dishId:e,cartId:this.cartID,amount:t}).subscribe((function(e){n.setCartId(e.cart.cartId),n.cart.next(e.cart),n.cartID=e.cart.cartId}),(function(){}))},e.prototype.checkoutCart=function(e){var t={cartId:this.cartID,address:{streetId:e.street.id,home:e.house,housing:e.housing,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:e.phone,name:e.name,mail:e.email||void 0}};return this.orderCart(t)},e.prototype.orderCart=function(e){var t=this;return this.net.post("/order",e).pipe(i.tap((function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId}),(function(e){console.log("Ошибка оформления!",e),e.error&&e.error.cart&&(t.setCartId(e.error.cart.cartId),t.cart.next(e.error.cart),t.cartID=e.error.cart.cartId)})))},e.prototype.checkStreetV2=function(e){var t=this;return this.net.post("/check",e).pipe(i.tap((function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId}),(function(){})))},e.prototype.checkStreet=function(e){var t=this;this.net.post("/check",e).subscribe((function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId}),(function(e){e.error&&e.error.cart&&(t.setCartId(e.error.cart.cartId),t.cart.next(e.error.cart),t.cartID=e.error.cart.cartId)}))},e.prototype.setCartId=function(e){localStorage.setItem("cartID",e),this.cartID=e},e.prototype.removeCartId=function(){localStorage.removeItem("cartID"),this.cartID=null},e.prototype.userCart=function(){return this.cart},e.prototype.setModifires=function(e,t){this.modifires.next(e),t&&this.modifiresMessage.next(t)},e.prototype.getModifires=function(){return this.modifires.pipe()},e.prototype.productInCart=function(e){return this.cart.pipe(i.filter((function(e){return"cartId"in e})),i.map((function(t){var n;return!(!t||!(null===(n=null==t?void 0:t.dishes)||void 0===n?void 0:n.find((function(t){return t.dish.id===e.id}))))})))},e.prototype.getPickupPoints=function(e){return this.net.get("/pickupaddreses",!0,{params:{cartId:e}})},e.prototype.getPaymentMethods=function(e){return this.net.get("/paymentmethods",!0,{params:{cartId:e}})},e}();s.ɵfac=function(e){return new(e||s)(t.ɵɵinject(r.NetService),t.ɵɵinject(r.EventerService))},s.ɵprov=t.ɵɵdefineInjectable({token:s,factory:s.ɵfac,providedIn:"root"});var d=function(){function e(e){var n=this;this.cartService=e,this.loading=new t.EventEmitter,this.success=new t.EventEmitter,this.error=new t.EventEmitter,this.cartService.userCart().subscribe((function(e){return n.cart=e})),this.cartService.getModifires().subscribe((function(e){return n.modifires=e}))}return e.prototype.onClick=function(){this.addDishToCart(this.dish.id,this.amountDish)},e.prototype.addDishToCart=function(e,t){var n=this,i={dishId:e,amount:t,cartId:void 0,modifiers:this.modifires,comment:this.comment};this.cart.cartId&&(i.cartId=this.cart.cartId),this.loading.emit(!0),this.cartService.addDishToCart$(i).subscribe((function(){return n.success.emit(!0)}),(function(e){return n.error.emit(e)}),(function(){return n.loading.emit(!1)}))},e}();d.ɵfac=function(e){return new(e||d)(t.ɵɵdirectiveInject(s))},d.ɵdir=t.ɵɵdefineDirective({type:d,selectors:[["","addToCart",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{modifires:"modifires",dish:"dish",amountDish:"amountDish",comment:"comment"},outputs:{loading:"loading",success:"success",error:"error"}});var a=function(e,t,n){var i=this;this.cartService=e,this.renderer=t,this.el=n,this.amount="0",this.renderer.setProperty(this.el.nativeElement,"innerHTML",this.amount),this.cartService.userCart().subscribe((function(e){i.cart=e,i.amount=e.dishesCount||0,i.renderer.setProperty(i.el.nativeElement,"innerHTML",i.amount)}))};a.ɵfac=function(e){return new(e||a)(t.ɵɵdirectiveInject(s),t.ɵɵdirectiveInject(t.Renderer2),t.ɵɵdirectiveInject(t.ElementRef))},a.ɵdir=t.ɵɵdefineDirective({type:a,selectors:[["","amountCart",""]]});var c=function(){function e(e){var n=this;this.cartService=e,this.success=new t.EventEmitter,this.error=new t.EventEmitter,this.isChecking=new t.EventEmitter,this.cartService.userCart().subscribe((function(e){return n.cart=e})),this.cartService.OrderFormChange.pipe(i.filter((function(){if(n.locationId||(n.streetId||n.street)&&n.home||n.selfService)return!0})),i.debounceTime(1e3)).subscribe((function(){return n.checkStreet()}))}return e.prototype.onClick=function(){var e=this;if(this.locationId||(this.streetId||this.street)&&this.home||this.selfService){var t=this.comment||"Не указан",n={cartId:this.cart.cartId,comment:t,customer:{phone:this.preparePhone(this.phone),mail:this.email,name:this.name},personsCount:+this.personsCount};this.paymentMethodId&&(n.paymentMethodId=this.paymentMethodId),this.date&&(n.date=this.date),this.notifyMethodId&&(n.notifyMethodId=this.notifyMethodId),n.selfService=this.selfService,this.bonuses&&(n.bonuses=this.bonuses.map((function(e){return{name:e.name,amount:e.amount}}))),this.locationId?n.locationId=this.locationId:n.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""};var i=this.cart.id;this.cartService.orderCart(n).subscribe((function(t){t.action&&t.action.paymentRedirect?window.location.href=t.action.paymentRedirect:e.success.emit(i)}),(function(t){return e.error.emit(t)}))}else this.error.emit("Нужно указать адрес")},e.prototype.ngOnChanges=function(e){this.cartService.OrderFormChange.next(e)},e.prototype.checkStreet=function(){var e=this,t=this.comment||"Не указан",n={cartId:this.cart.cartId,comment:t,customer:{phone:this.phone?this.preparePhone(this.phone):null,mail:this.email,name:this.name||null},personsCount:+this.personsCount};n.selfService=this.selfService,this.paymentMethodId&&(n.paymentMethodId=this.paymentMethodId),this.date&&(n.date=this.date),this.notifyMethodId&&(n.notifyMethodId=this.notifyMethodId),this.locationId?n.locationId=this.locationId:n.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""},this.isChecking.emit(!0),this.cartService.checkStreetV2(n).subscribe((function(){return e.isChecking.emit(!1)}),(function(){return e.isChecking.emit(!1)}))},e.prototype.preparePhone=function(e){return e?(e="+"+e.replace(/[^0-9]/gim,"")).replace("+8","+7"):""},e}();c.ɵfac=function(e){return new(e||c)(t.ɵɵdirectiveInject(s))},c.ɵdir=t.ɵɵdefineDirective({type:c,selectors:[["","checkout",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{cartTotal:"cartTotal",bonuses:"bonuses",name:"name",email:"email",phone:"phone",delivery:"delivery",selfService:"selfService",locationId:"locationId",street:"street",streetId:"streetId",home:"home",housing:"housing",apartment:"apartment",entrance:"entrance",doorphone:"doorphone",floor:"floor",paymentMethod:"paymentMethod",paymentMethodId:"paymentMethodId",personsCount:"personsCount",comment:"comment",date:"date",notifyMethodId:"notifyMethodId"},outputs:{success:"success",error:"error",isChecking:"isChecking"},features:[t.ɵɵNgOnChangesFeature]});var l=function(){function e(e){var t=this;this.cartService=e,this.cartService.userCart().subscribe((function(e){return t.cart=e}))}return e.prototype.onClick=function(){this.cartService.removeDishFromCart(this.dish.id,this.amountDish)},e}();l.ɵfac=function(e){return new(e||l)(t.ɵɵdirectiveInject(s))},l.ɵdir=t.ɵɵdefineDirective({type:l,selectors:[["","deleteFromCart",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{dish:"dish",amountDish:"amountDish"}});var m=function(){function e(e,n,i){this.renderer=e,this.el=n,this.cartService=i,this.validate=new t.EventEmitter,this.amountDishToAdd=new t.EventEmitter,this.amountModifires={},this.stateModifiers={}}return e.prototype.ngOnInit=function(){var e=this;this.renderer.addClass(this.el.nativeElement,"dish-calculator"),this.amountDish=this.amount,this.amountDishToAdd.emit(this.amountDish),this.price=this.renderer.createElement("div"),this.renderer.addClass(this.price,"dish-price"),setTimeout((function(){e.renderDish(e.dish),e.render(e.dish.modifiers)}),100)},e.prototype.renderDish=function(e){var t=this,n=this.renderer.createElement("div");this.renderer.addClass(n,"dish-wraper"),this.renderer.appendChild(this.el.nativeElement,n);var i=this.renderer.createElement("div");this.renderer.addClass(i,"name"),this.renderer.appendChild(n,i);var r=this.renderer.createElement("div");this.renderer.addClass(r,"title"),this.renderer.setProperty(r,"innerHTML",this.dish.name),this.renderer.appendChild(i,r);var o=this.renderer.createElement("div");this.renderer.addClass(i,"weight"),this.renderer.addClass(i,"dish"),this.renderer.appendChild(n,o);var s=this.renderer.createElement("div");this.renderer.addClass(s,"value"),this.renderer.setProperty(s,"innerHTML",(1e3*this.dish.weight).toFixed(0)+" г."),0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(s,"zero"),this.renderer.appendChild(o,s),this.renderer.setProperty(this.price,"innerHTML",this.dish.price);var d=this.renderer.createElement("div");this.renderer.addClass(d,"price"),this.renderer.addClass(d,"total"),this.renderer.appendChild(d,this.price),this.renderer.appendChild(n,d);var a=this.renderer.createElement("div");this.renderer.addClass(a,"quantity"),this.renderer.appendChild(n,a);var c=this.renderer.createElement("a");this.renderer.addClass(c,"quantity__button"),this.renderer.addClass(c,"minus"),this.renderer.setProperty(c,"innerHTML","&#8722;"),this.renderer.listen(c,"click",(function(e){t.changeAmountdish(-1),t.renderer.setProperty(l,"innerHTML",t.amountDish),t.renderer.setProperty(t.price,"innerHTML",t.generatePrice(t.dish.price)),t.innerTotalWeight(p)})),this.renderer.appendChild(a,c);var l=this.renderer.createElement("span");this.renderer.addClass(l,"quantity__counter"),this.renderer.setProperty(l,"innerHTML",this.amountDish),this.renderer.appendChild(a,l);var m=this.renderer.createElement("a");this.renderer.addClass(m,"quantity__button"),this.renderer.addClass(c,"plus"),this.renderer.setProperty(m,"innerHTML","&#x2b;"),this.renderer.listen(m,"click",(function(e){t.changeAmountdish(1),t.renderer.setProperty(l,"innerHTML",t.amountDish),t.renderer.setProperty(t.price,"innerHTML",t.generatePrice(t.dish.price)),t.innerTotalWeight(p)})),this.renderer.appendChild(a,m);var h=this.renderer.createElement("div");this.renderer.addClass(i,"weight"),this.renderer.addClass(i,"total"),this.renderer.appendChild(n,h);var p=this.renderer.createElement("div");0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(p,"zero"),this.renderer.addClass(p,"value"),this.innerTotalWeight(p),this.renderer.appendChild(h,p),this.weightTotal=p,this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(e.price));var u=this.renderer.createElement("div");this.renderer.addClass(u,"price"),this.renderer.addClass(u,"total"),this.renderer.appendChild(u,this.price),this.renderer.appendChild(n,u)},e.prototype.generatePrice=function(e,t,n){var i=this,r=[];this.selectedModifiers&&this.selectedModifiers.forEach((function(e){i.dish.modifiers.forEach((function(t){var n=t.childModifiers.filter((function(t){return t.modifierId===e.id}));n.length>0&&(n[0].groupId=t.group.id,r.push(n[0]))}))}));var o=0;return r.forEach((function(e){o+=e.dish.price*i.amountModifires[e.groupId][e.modifierId]})),o*=this.amountDish,e*this.amountDish+o+'<div class="currency">&nbsp;&#x20bd;</div>'},e.prototype.generateTotalWeight=function(){var e=this,t=[];this.selectedModifiers&&this.selectedModifiers.forEach((function(n){e.dish.modifiers.forEach((function(e){var i=e.childModifiers.filter((function(e){return e.modifierId===n.id}));i.length>0&&(i[0].groupId=e.group.id,t.push(i[0]))}))}));var n=0;return t.forEach((function(t){n+=t.dish.weight*e.amountModifires[t.groupId][t.modifierId]*1e3})),n=parseFloat((n*this.amountDish).toFixed(2)),console.log(n,1e3*this.dish.weight*this.amountDish),console.log(this.dish.weight,this.amountDish),(1e3*this.dish.weight*this.amountDish+n).toFixed(0)+" г. <div class='separator'></div>"},e.prototype.innerTotalWeight=function(e){this.renderer.setProperty(e,"innerHTML",this.generateTotalWeight())},e.prototype.changeAmountdish=function(e){this.amountDish=this.amountDish+e,this.amountDish<=0&&(this.amountDish=1),this.amountDish>=199&&(this.amountDish=199),this.amountDishToAdd.emit(this.amountDish)},e.prototype.render=function(e){var t=this;if(this.setModifires(),e.length>0){var n=this.renderer.createElement("h5");this.renderer.setProperty(n,"innerHTML","К этому блюду можно добавить:")}if(e.forEach((function(e){if(t.stateModifiers[e.modifierId]={},t.amountModifires[e.modifierId]={},e.dish){var n=t.groupDiv("Одночные модификаторы не поддерживаются");t.renderer.appendChild(t.el.nativeElement,n),console.log("elementGroup",e)}else if(e.childModifiers){var i=t.groupDiv(e.group?e.group.name:"Ошибка");t.renderer.appendChild(t.el.nativeElement,i),e.childModifiers.forEach((function(n){var r=t.modifireDiv(n,e.modifierId);t.renderer.appendChild(i,r),n.defaultAmount<1?t.stateModifiers[e.modifierId][n.modifierId]=!1:t.stateModifiers[e.modifierId][n.modifierId]=!0}))}})),e.length>0){n=this.renderer.createElement("div");this.renderer.setProperty(n,"innerHTML","<p>* — Количество добавленых опций блюда применяется для каждой порции</p>"),this.renderer.appendChild(this.el.nativeElement,n)}},e.prototype.groupDiv=function(e){var t=this.renderer.createElement("div");return this.renderer.addClass(t,"group-modifires-wraper"),this.renderer.appendChild(t,this.renderer.createText(""+e)),t},e.prototype.modifireDiv=function(e,t){var n=this.renderer.createElement("div");return this.renderer.addClass(n,"additional-item"),this.renderOneModifire(e,n,t),n},e.prototype.renderOneModifire=function(e,t,n){console.info("renderOneModifire",e),console.info("renderOneModifire selectedModifiers",this.selectedModifiers);var i=this.renderer.createElement("div");this.renderer.addClass(i,"item-name");var r=this.renderer.createElement("label");this.renderer.setAttribute(r,"for",e.modifierId),this.renderer.appendChild(i,r),this.renderer.setProperty(r,"innerHTML",e.dish.name),this.renderer.appendChild(t,i);var o=this.renderer.createElement("div");this.renderer.addClass(o,"left-weight-modifire-wraper");var s=this.renderer.createElement("div");this.renderer.addClass(s,"weight"),(0===e.dish.weight||e.dish.weight<0)&&this.renderer.addClass(s,"zero"),this.renderer.setProperty(s,"innerHTML",(1e3*e.dish.weight).toFixed(0)+" г."),this.renderer.appendChild(o,s),this.renderer.appendChild(t,o);var d=this.renderer.createElement("div"),a=e.minAmount,c=e.maxAmount,l=e.defaultAmount;switch(console.info("min max def",a,c,l),!0){case 0===a&&0===c&&0===l:case 0===a&&1===c&&0===l:this.renderCheckbox(e,!1,d,t,n);break;case 0===a&&1===c&&1===l:this.renderCheckbox(e,!0,d,t,n);break;case 1===a&&1===c&&1===l:console.error(e.dish.name,"Значение не поддается настройке:",a,c,l);break;case a<=c&&l>=a&&l<=c&&c>1:this.renderInputButton(e,n,d,t);break;default:console.error(e.dish.name,"Ошибка рендера модификатора, для значений:",a,c,l)}e.maxAmount>0&&e.minAmount;var m=this.renderer.createElement("div");this.renderer.addClass(m,"right-weight-modifire-wraper");var h=this.renderer.createElement("div");this.renderer.addClass(h,"weight"),(0===e.dish.weight||e.dish.weight<0)&&this.renderer.addClass(h,"zero"),this.renderer.setProperty(h,"innerHTML",(1e3*e.dish.weight).toFixed(0)+' г.<div class="separator"></div>'),this.renderer.appendChild(m,h),this.renderer.appendChild(t,m);var p,u=this.renderer.createElement("div");this.renderer.addClass(u,"item-price"),e.dish.price>0?(p=e.dish.price+"<div class = 'currency'>&nbsp;&#x20bd;</div>",this.renderer.setProperty(u,"innerHTML",p),this.renderer.appendChild(t,u)):this.renderer.addClass(u,"zero-price"),this.setModifires(),this.innerTotalWeight(this.weightTotal),this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(this.dish.price))},e.prototype.renderCheckbox=function(e,t,n,i,r){var o=this,s=this.renderer.createElement("input");this.renderer.setAttribute(s,"type","checkbox"),this.renderer.setAttribute(s,"id",e.modifierId),t?(this.renderer.setProperty(s,"checked",!0),e.checked=!0,this.stateModifiers[r][e.modifierId]=!0,this.amountModifires[r][e.modifierId]=1):(e.checked=!1,this.stateModifiers[r][e.modifierId]=!1,this.amountModifires[r][e.modifierId]=0),this.renderer.addClass(s,"modal-checkbox"),this.renderer.appendChild(n,s),this.renderer.listen(s,"change",(function(e){if(o.idRadioBox(r)){for(var t in o.stateModifiers[r])o.stateModifiers[r].hasOwnProperty(t)&&(o.stateModifiers[r][t]=!1);e.target.parentElement.parentElement.parentElement.querySelectorAll("input").forEach((function(t){t.id!=e.target.id&&(t.checked=!1)}))}o.stateModifiers[r][e.target.id]=e.target.checked,e.target.checked&&(o.amountModifires[r][e.target.id]=1),o.setModifires(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))})),this.renderer.appendChild(i,n)},e.prototype.renderInputButton=function(e,t,n,i){var r,o=this;(r=e.defaultAmount>0?e.defaultAmount:e.minAmount)>0&&(this.stateModifiers[t][e.modifierId]=!0);var s=this.renderer.createElement("a");this.renderer.addClass(s,"quantity__button"),this.renderer.setProperty(s,"innerHTML","&#8722;"),this.renderer.appendChild(n,s),this.renderer.listen(s,"click",(function(n){var i=+o.amountModifires[t][e.modifierId];o.amountModifires[t][e.modifierId]=i-1,o.amountModifires[t][e.modifierId]<e.minAmount&&(o.amountModifires[t][e.modifierId]=e.minAmount),o.renderer.setProperty(d,"innerHTML",o.amountModifires[t][e.modifierId]),0===o.amountModifires[t][e.modifierId]&&(o.stateModifiers[t][e.modifierId]=!1),o.setModifires(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))}));var d=this.renderer.createElement("span");this.renderer.addClass(d,"item-quantity__counter"),this.amountModifires[t][e.modifierId]=r,this.renderer.setProperty(d,"innerHTML",this.amountModifires[t][e.modifierId]),this.renderer.appendChild(n,d);var a=this.renderer.createElement("a");this.renderer.addClass(a,"quantity__button"),this.renderer.setProperty(a,"innerHTML","&#x2b;"),this.renderer.appendChild(n,a),this.renderer.appendChild(i,n),this.renderer.listen(a,"click",(function(n){var i=+o.amountModifires[t][e.modifierId];o.amountModifires[t][e.modifierId]=i+1,o.amountModifires[t][e.modifierId]>e.maxAmount&&0!=e.maxAmount&&(o.amountModifires[t][e.modifierId]=e.maxAmount),o.renderer.setProperty(d,"innerHTML",o.amountModifires[t][e.modifierId]),o.amountModifires[t][e.modifierId]>0&&(o.stateModifiers[t][e.modifierId]=!0),o.setModifires(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))}))},e.prototype.setModifires=function(){var e=this,t=[],n=[];for(var i in console.info("setModifires modifiersToSelect",t),console.info("setModifires stateModifiers before",this.stateModifiers),console.info("setModifires selectedModifiers before",this.selectedModifiers),this.stateModifiers){var r=function(e){(o.stateModifiers[i][e]||t.find((function(t){return t.modifierId==e})))&&n.push({id:e,amount:o.amountModifires[i][e],groupId:i})},o=this;for(var s in this.stateModifiers[i])r(s)}if(this.selectedModifiers=n,this.dish.modifiers.length>0){var d=[];this.dish.modifiers.forEach((function(t){if(t.required)if(e.stateModifiers[t.modifierId]){var i=[],r=e.stateModifiers[t.modifierId];for(var o in r)r.hasOwnProperty(o)&&r[o]&&i.push(r[o]);i.length<t.minAmount?(d.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+t.group.name}),e.validate.emit(!1),e.cartService.setModifires(n,d)):(e.validate.emit(!0),e.cartService.setModifires(n,[]))}else d.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+t.group.name}),e.validate.emit(!1),e.cartService.setModifires(n,d);else e.validate.emit(!0),e.cartService.setModifires(n)}))}else this.validate.emit(!0),this.cartService.setModifires(n,[]);console.info("setModifires stateModifiers after",this.stateModifiers),console.info("setModifires selectedModifiers after",this.selectedModifiers)},e.prototype.idRadioBox=function(e){var t=this.dish.modifiers.find((function(t){return t.modifierId===e}));return 1===t.minAmount&&1===t.maxAmount},e.prototype.checkMinAmountModifires=function(e,t){},e.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifires([],[])},e}();m.ɵfac=function(e){return new(e||m)(t.ɵɵdirectiveInject(t.Renderer2),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(s))},m.ɵdir=t.ɵɵdefineDirective({type:m,selectors:[["","dishCalc",""]],inputs:{dish:"dish",amount:"amount",selectedModifiers:"selectedModifiers"},outputs:{validate:"validate",amountDishToAdd:"amountDishToAdd"}});var h=function(){function e(e,t,n){var i=this;this.renderer=e,this.el=t,this.cartService=n,this.amountModifires={},this.stateModifires={},setTimeout((function(){i.render(i.modifires)}),100)}return e.prototype.render=function(e){var t=this;if(e.length>0){var n=this.renderer.createElement("h5");this.renderer.setProperty(n,"innerHTML","К этому блюду можно добавить:"),this.renderer.appendChild(this.el.nativeElement,n)}e.forEach((function(e){t.stateModifires[e.modifierId]={},t.amountModifires[e.modifierId]={};var n=t.groupDiv(e.name);t.renderer.appendChild(t.el.nativeElement,n),(e.childModifiers.length>5?e.childModifiers.slice(0,5):e.childModifiers).forEach((function(i){var r=t.modifireDiv(i,e.modifierId);t.renderer.appendChild(n,r),t.stateModifires[e.modifierId][i.modifierId]=!1}))}))},e.prototype.groupDiv=function(e){var t=this.renderer.createElement("div");return this.renderer.addClass(t,"group-modifires"),this.renderer.appendChild(t,this.renderer.createText("Название категории модификаторов: "+e)),t},e.prototype.modifireDiv=function(e,t){var n=this.renderer.createElement("div");return this.renderer.addClass(n,"additional-item"),this.renderOneModifire(e,n,t),n},e.prototype.renderOneModifire=function(e,t,n){var i=this,r=this.renderer.createElement("div");this.renderer.addClass(r,"item-name");var o=this.renderer.createElement("input");this.renderer.setAttribute(o,"type","checkbox"),this.renderer.setAttribute(o,"id",e.modifierId),this.renderer.appendChild(r,o),this.renderer.listen(o,"change",(function(e){i.stateModifires[n][e.target.id]=e.target.checked,i.setModifires()}));var s=this.renderer.createElement("label");this.renderer.setAttribute(s,"for",e.modifierId),this.renderer.appendChild(r,s),this.renderer.setProperty(s,"innerHTML",e.dish.name),this.renderer.appendChild(t,r);var d=this.renderer.createElement("div"),a=this.renderer.createElement("a");this.renderer.addClass(a,"item-quantity__button"),this.renderer.setProperty(a,"innerHTML","&#8722;"),this.renderer.appendChild(d,a),this.renderer.listen(a,"click",(function(t){var r=+i.amountModifires[n][e.modifierId];i.amountModifires[n][e.modifierId]=r-1,i.amountModifires[n][e.modifierId]<e.minAmount&&(i.amountModifires[n][e.modifierId]=e.minAmount),i.renderer.setProperty(c,"innerHTML",i.amountModifires[n][e.modifierId]),i.setModifires()}));var c=this.renderer.createElement("span");this.renderer.addClass(c,"item-quantity__counter"),this.amountModifires[n][e.modifierId]=e.minAmount,this.renderer.setProperty(c,"innerHTML",this.amountModifires[n][e.modifierId]),this.renderer.appendChild(d,c);var l=this.renderer.createElement("a");this.renderer.addClass(l,"item-quantity__button"),this.renderer.setProperty(l,"innerHTML","&#x2b;"),this.renderer.appendChild(d,l),this.renderer.appendChild(t,d),this.renderer.listen(l,"click",(function(t){var r=+i.amountModifires[n][e.modifierId];i.amountModifires[n][e.modifierId]=r+1,i.renderer.setProperty(c,"innerHTML",i.amountModifires[n][e.modifierId]),i.setModifires()}));var m=this.renderer.createElement("div");this.renderer.addClass(m,"weight-price");var h=e.dish.weight+" г / "+e.dish.price+"&nbsp;&#x20bd;";this.renderer.setProperty(m,"innerHTML",h),this.renderer.appendChild(t,m),this.setModifires()},e.prototype.setModifires=function(){var e=[];for(var t in this.stateModifires)for(var n in this.stateModifires[t])this.stateModifires[t][n]&&e.push({id:n,amount:this.amountModifires[t][n],groupId:t});console.log("модифікатори після циклу",e),this.cartService.setModifires(e)},e}();h.ɵfac=function(e){return new(e||h)(t.ɵɵdirectiveInject(t.Renderer2),t.ɵɵdirectiveInject(t.ElementRef),t.ɵɵdirectiveInject(s))},h.ɵdir=t.ɵɵdefineDirective({type:h,selectors:[["","modifires",""]],inputs:{modifires:"modifires"}});var p=function(){function e(e){this.cartService=e,this.requiredFields=["name","phone","street","house"],this.checkerFields=new n.BehaviorSubject(void 0)}return e.prototype.onClick=function(){this.order(this.orderCart.value),console.log(this.orderCart.value)},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout((function(){e.cartService.userCart().subscribe((function(t){e.cart&&e.orderCart.valid&&e.cart.cartTotal!=t.cartTotal&&t.cartTotal>0&&e.checkStreet(e.orderCart.value),e.cart=t}))}),100),setTimeout((function(){e.checkerFields.next(e.checkForFields(e.orderCart._directives,e.requiredFields))}),100),this.checkerFields.subscribe((function(t){t&&(e.orderCart.controls.street.valueChanges.subscribe((function(t){"object"==typeof t&&setTimeout((function(){e.orderCart.controls.house.valid&&(e.orderCart.value.name=e.orderCart.value.name||"Неуказано",e.orderCart.value.phone=e.orderCart.value.phone||"78888888888",e.checkStreet(e.orderCart.value))}),100)})),e.orderCart.controls.house.valueChanges.subscribe((function(t){setTimeout((function(){e.orderCart.controls.street.valid&&(e.orderCart.value.name=e.orderCart.value.name||"Неуказано",e.orderCart.value.phone=e.orderCart.value.phone||"78888888888",e.checkStreet(e.orderCart.value))}),100)})))}))},e.prototype.checkForFields=function(e,t){var n={},i=[];return e.forEach((function(e){n[e.name]=!0})),t.forEach((function(e){n.hasOwnProperty(e)||i.push(e)})),i.length<=0||(console.error("У формы отсутсвуют следующие обязательные для корректной работы модуля поля:",i),!1)},e.prototype.order=function(e){if(this.checkForFields(this.orderCart._directives,this.requiredFields)){var t=void 0,n=e.comment||"Не указан";t=e.cash?"Наличными курьеру":e.bankcard?"Банковской картой курьеру":"Не указан",console.log(e);var i={cartId:this.cart.cartId,comment:"\n Тип оплаты:"+t+"\nКоментарий:"+n,address:{streetId:e.street.id,home:e.house,housing:e.housing,doorphone:e.doorphone,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:"+"+e.phone,mail:e.email,name:e.name},personsCount:e.personsCount};this.cartService.orderCart(i).subscribe()}},e.prototype.checkStreet=function(e){if(console.log(">>>>",e),this.checkForFields(this.orderCart._directives,this.requiredFields)){var t={cartId:this.cart.cartId,comment:e.comment,address:{streetId:e.street.id,home:e.house,housing:e.housing,doorphone:e.doorphone,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:"+"+e.phone,mail:e.email,name:e.name},personsCount:e.personsCount};this.cartService.checkStreet(t)}},e.prototype.stringToNumber=function(e){return console.log(typeof e),"string"==typeof e?+e:"number"==typeof e?e:void console.error("Параметр home должен быть или string или number")},e}();p.ɵfac=function(e){return new(e||p)(t.ɵɵdirectiveInject(s))},p.ɵdir=t.ɵɵdefineDirective({type:p,selectors:[["","orderCart",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{orderCart:"orderCart"}});var u=function(){function e(e){var t=this;this.cartService=e,this.cartService.userCart().subscribe((function(e){return t.cart=e}))}return e.prototype.onClick=function(){this.changeAmount(this.action)},e.prototype.changeAmount=function(e){switch(e){case"+":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount+1);break;case"-":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount-1);break;default:console.log("Директива SetDishAmount получила ложное значение action")}},e}();u.ɵfac=function(e){return new(e||u)(t.ɵɵdirectiveInject(s))},u.ɵdir=t.ɵɵdefineDirective({type:u,selectors:[["","setDishAmount",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{action:"action",dish:"dish"}});var f=function(){function e(e){this.cartService=e,this.success=new t.EventEmitter,this.error=new t.EventEmitter}return e.prototype.onClick=function(){this.setComment()},e.prototype.setComment=function(){var e=this;this.cartService.setDishComment(this.dish.id,this.comment).subscribe((function(t){return e.success.emit(!0)}),(function(t){return e.error.emit(t)}))},e}();f.ɵfac=function(e){return new(e||f)(t.ɵɵdirectiveInject(s))},f.ɵdir=t.ɵɵdefineDirective({type:f,selectors:[["","setDishComment",""]],hostBindings:function(e,n){1&e&&t.ɵɵlistener("click",(function(){return n.onClick()}))},inputs:{comment:"comment",dish:"dish"},outputs:{success:"success",error:"error"}});Object.create;function g(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;function v(e,n){1&e&&t.ɵɵelementContainer(0)}var C=function(e){return{"zero-price":e}};function x(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",20),t.ɵɵelementStart(2,"span"),t.ɵɵtext(3),t.ɵɵelementEnd(),t.ɵɵtext(4," ₽ "),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(2,C,!i.dish.price)),t.ɵɵadvance(2),t.ɵɵtextInterpolate(i.dish.price)}}var M=function(e){return{selected:e}};function I(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",24),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.$implicit;return t.ɵɵnextContext(4).changeModifierAmount(e,1,"checkbox")})),t.ɵɵtext(2),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()}if(2&e){var r=n.$implicit,o=t.ɵɵnextContext().ngIf,s=t.ɵɵnextContext(3);t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(2,M,!!s.modifiersValueTree[o.modifierId][r.modifierId])),t.ɵɵadvance(1),t.ɵɵtextInterpolate1(" ",null==r.dish?null:r.dish.name," ")}}function b(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",20),t.ɵɵelementStart(2,"span"),t.ɵɵtext(3),t.ɵɵelementEnd(),t.ɵɵtext(4," ₽ "),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit;t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(2,C,!(null!=i.dish&&i.dish.price))),t.ɵɵadvance(2),t.ɵɵtextInterpolate(null==i.dish?null:i.dish.price)}}function y(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,b,5,4,"ng-container",21),t.ɵɵelementContainerEnd()),2&e){var i=n.$implicit,r=t.ɵɵnextContext().ngIf,o=t.ɵɵnextContext(3);t.ɵɵadvance(1),t.ɵɵproperty("ngIf",!!o.modifiersValueTree[r.modifierId][i.modifierId])}}function P(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",22),t.ɵɵtemplate(2,I,3,4,"ng-container",23),t.ɵɵelementEnd(),t.ɵɵtemplate(3,y,2,1,"ng-container",23),t.ɵɵelementContainerEnd()),2&e){var i=n.ngIf;t.ɵɵadvance(2),t.ɵɵproperty("ngForOf",i.childModifiers),t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",i.childModifiers)}}function O(e,n){if(1&e&&t.ɵɵtemplate(0,P,4,2,"ng-container",21),2&e){var i=t.ɵɵnextContext(2);t.ɵɵproperty("ngIf",i.modifiers.custom.fixed)}}function w(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",32),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().ngIf;t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.name)}}function _(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",33),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().ngIf;t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.description)}}function E(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",29),t.ɵɵtemplate(1,w,2,1,"div",30),t.ɵɵtemplate(2,_,2,1,"div",31),t.ɵɵelementEnd()),2&e){var i=n.ngIf;t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.name),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.description)}}function T(e,n){1&e&&t.ɵɵelementContainer(0)}var S=function(e){return{"without-images":e}},A=function(e,t,n,i,r){return{modifier:e,groupId:"single",amount:t,groupAmount:n,groupMinAmount:i,groupMaxAmount:r}};function k(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,E,3,2,"div",27),t.ɵɵelementStart(2,"div",28),t.ɵɵtemplate(3,T,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit,r=t.ɵɵnextContext(3),o=t.ɵɵreference(4);t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.group),t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(4,S,!i.childImagesIsset)),t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",o)("ngTemplateOutletContext",t.ɵɵpureFunction5(6,A,i,r.modifiersValueTree.single[i.modifierId],r.modifiersValueTree.single[i.modifierId],i.minAmount||0,i.maxAmount||100))}}function D(e,n){1&e&&t.ɵɵelementContainer(0)}function F(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",32),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().ngIf;t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.name)}}function j(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",33),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().ngIf;t.ɵɵadvance(1),t.ɵɵtextInterpolate(i.description)}}function B(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",29),t.ɵɵtemplate(1,F,2,1,"div",30),t.ɵɵtemplate(2,j,2,1,"div",31),t.ɵɵelementEnd()),2&e){var i=n.ngIf;t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.name),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.description)}}function L(e,n){1&e&&t.ɵɵelementContainer(0)}var V=function(e,t,n,i,r,o){return{modifier:e,groupId:t,amount:n,groupAmount:i,groupMinAmount:r,groupMaxAmount:o}};function H(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,L,1,0,"ng-container",8),t.ɵɵelementContainerEnd()),2&e){var i=n.$implicit,r=t.ɵɵnextContext(3).$implicit,o=t.ɵɵnextContext(3),s=t.ɵɵreference(4);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",s)("ngTemplateOutletContext",t.ɵɵpureFunction6(2,V,i,r.modifierId,o.modifiersValueTree[r.modifierId][i.modifierId],o.modifiers.indexById[r.modifierId].totalAmount,r.minAmount||0,r.maxAmount||100))}}function z(e,n){if(1&e&&(t.ɵɵtemplate(0,B,3,2,"div",27),t.ɵɵelementStart(1,"div",37),t.ɵɵtemplate(2,H,2,9,"ng-container",23),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext(2).$implicit;t.ɵɵproperty("ngIf",i.group),t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(3,S,!i.imagesIsset)),t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",i.childModifiers)}}function R(e,n){1&e&&t.ɵɵelementContainer(0)}var G=function(e){return{dish:e}};function $(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",43),t.ɵɵelementStart(2,"div",44),t.ɵɵtext(3),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",45),t.ɵɵtemplate(5,R,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=n.ngIf;t.ɵɵnextContext(8);var r=t.ɵɵreference(2);t.ɵɵadvance(3),t.ɵɵtextInterpolate(i.name),t.ɵɵadvance(2),t.ɵɵproperty("ngTemplateOutlet",r)("ngTemplateOutletContext",t.ɵɵpureFunction1(3,G,i))}}function q(e,n){1&e&&t.ɵɵelementContainer(0)}var N=function(){return{}};function W(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",43),t.ɵɵelementStart(2,"div",44),t.ɵɵtext(3,"Выберите половину"),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",45),t.ɵɵtemplate(5,q,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){t.ɵɵnextContext(8);var i=t.ɵɵreference(2);t.ɵɵadvance(5),t.ɵɵproperty("ngTemplateOutlet",i)("ngTemplateOutletContext",t.ɵɵpureFunction1(3,G,t.ɵɵpureFunction0(2,N)))}}function Z(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,$,6,5,"ng-container",21),t.ɵɵtemplate(2,W,6,5,"ng-container",21),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().$implicit,r=t.ɵɵnextContext(3).$implicit,o=t.ɵɵnextContext(3);t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.dish),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",1==o.modifiers.indexById[r.modifierId].totalAmount)}}function U(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,Z,3,2,"ng-container",21),t.ɵɵelementContainerEnd()),2&e){var i=n.$implicit,r=t.ɵɵnextContext(3).$implicit,o=t.ɵɵnextContext(3);t.ɵɵadvance(1),t.ɵɵproperty("ngIf",o.modifiersValueTree[r.modifierId][i.modifierId])}}function J(e,n){1&e&&t.ɵɵelementContainer(0)}function K(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",47),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵnextContext().$implicit;return t.ɵɵnextContext(6).selectTwoPartsAssembledModifier(e)})),t.ɵɵelementStart(1,"div",45),t.ɵɵtemplate(2,J,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",10),t.ɵɵtext(4),t.ɵɵelementEnd(),t.ɵɵelementStart(5,"div",48),t.ɵɵelementStart(6,"div",49),t.ɵɵelementStart(7,"span"),t.ɵɵtext(8),t.ɵɵelementEnd(),t.ɵɵtext(9," ₽ "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}if(2&e){var r=n.ngIf,o=t.ɵɵnextContext().$implicit,s=t.ɵɵnextContext(3).$implicit,d=t.ɵɵnextContext(3),a=t.ɵɵreference(2);t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(6,M,d.modifiersValueTree[s.modifierId][o.modifierId])),t.ɵɵadvance(2),t.ɵɵproperty("ngTemplateOutlet",a)("ngTemplateOutletContext",t.ɵɵpureFunction1(8,G,r)),t.ɵɵadvance(2),t.ɵɵtextInterpolate1(" ",r.name," "),t.ɵɵadvance(2),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(10,C,!r.price)),t.ɵɵadvance(2),t.ɵɵtextInterpolate(r.price)}}function Q(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,K,10,12,"div",46),t.ɵɵelementContainerEnd()),2&e){var i=n.$implicit;t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.dish)}}var Y=function(e){return{empty:e}};function X(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",38),t.ɵɵelementStart(1,"div",39),t.ɵɵtemplate(2,U,2,1,"ng-container",23),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",40),t.ɵɵelementStart(4,"div",41),t.ɵɵtext(5,"Выберите любые две половинки"),t.ɵɵelementEnd(),t.ɵɵelementStart(6,"div",42),t.ɵɵtemplate(7,Q,2,1,"ng-container",23),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext(2).$implicit,r=t.ɵɵnextContext(3);t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(3,Y,!(null!=r.twoPartsAssembledModifiersIdsByGroupId[i.modifierId]&&r.twoPartsAssembledModifiersIdsByGroupId[i.modifierId].length))),t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",i.childModifiers),t.ɵɵadvance(5),t.ɵɵproperty("ngForOf",i.childModifiers)}}function ee(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,D,1,0,"ng-container",34),t.ɵɵtemplate(2,z,3,5,"ng-template",null,35,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(4,X,8,5,"ng-template",null,36,t.ɵɵtemplateRefExtractor),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵreference(3),r=t.ɵɵreference(5),o=t.ɵɵnextContext().$implicit;t.ɵɵadvance(1),t.ɵɵproperty("ngIf",2==o.minAmount&&2==o.maxAmount)("ngIfThen",r)("ngIfElse",i)}}function te(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",26),t.ɵɵtemplate(2,k,4,12,"ng-container",21),t.ɵɵtemplate(3,ee,6,3,"ng-container",21),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=n.$implicit;t.ɵɵadvance(2),t.ɵɵproperty("ngIf",i.dish),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",null==i.childModifiers?null:i.childModifiers.length)}}function ne(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",25),t.ɵɵtemplate(1,te,4,2,"ng-container",23),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext(2);t.ɵɵadvance(1),t.ɵɵproperty("ngForOf",i.modifiers.baseList)}}function ie(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementStart(0,"div",50),t.ɵɵelementStart(1,"div",44),t.ɵɵtext(2,"Комментарий"),t.ɵɵelementEnd(),t.ɵɵelementStart(3,"div",51),t.ɵɵelementStart(4,"input",52,53),t.ɵɵlistener("keyup",(function(){t.ɵɵrestoreView(i);var e=t.ɵɵreference(5);return t.ɵɵnextContext(2).comment.emit(e.value)})),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd()}}var re=function(e){return{"ng-cart-dish-calc-two-parts-assembled":e}};function oe(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",5),t.ɵɵelementStart(1,"div",6),t.ɵɵelementStart(2,"div",7),t.ɵɵtemplate(3,v,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",9),t.ɵɵelementStart(5,"div",10),t.ɵɵtext(6),t.ɵɵelementEnd(),t.ɵɵelementStart(7,"div",11),t.ɵɵtext(8),t.ɵɵelementEnd(),t.ɵɵelementStart(9,"div",12),t.ɵɵtemplate(10,x,5,4,"ng-container",13),t.ɵɵtemplate(11,O,1,1,"ng-template",null,14,t.ɵɵtemplateRefExtractor),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(13,ne,2,1,"div",15),t.ɵɵelementStart(14,"div",16),t.ɵɵelementStart(15,"span",17),t.ɵɵtext(16,"ИТОГО:"),t.ɵɵelementEnd(),t.ɵɵelementStart(17,"span",18),t.ɵɵelementStart(18,"span"),t.ɵɵtext(19),t.ɵɵelementEnd(),t.ɵɵtext(20," ₽ "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵtemplate(21,ie,6,0,"div",19),t.ɵɵelementEnd()),2&e){var i=t.ɵɵreference(12),r=t.ɵɵnextContext(),o=t.ɵɵreference(2);t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(10,re,r.isTwoPartsAssembledTemplate)),t.ɵɵadvance(3),t.ɵɵproperty("ngTemplateOutlet",o)("ngTemplateOutletContext",t.ɵɵpureFunction1(12,G,r.dish)),t.ɵɵadvance(3),t.ɵɵtextInterpolate(r.dish.name),t.ɵɵadvance(2),t.ɵɵtextInterpolate(r.dish.description),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",!r.modifiers.custom.fixed)("ngIfElse",i),t.ɵɵadvance(3),t.ɵɵproperty("ngIf",null==r.modifiers.baseList?null:r.modifiers.baseList.length),t.ɵɵadvance(6),t.ɵɵtextInterpolate(r.totalPrice),t.ɵɵadvance(2),t.ɵɵproperty("ngIf",r.isTwoPartsAssembledTemplate)}}function se(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelement(1,"div",55),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext().dish,r=t.ɵɵnextContext();t.ɵɵadvance(1),t.ɵɵstyleProp("background-image","url("+r.imageUrl+i.images[0].images.small+")")}}function de(e,n){1&e&&t.ɵɵelement(0,"div",56)}function ae(e,n){if(1&e&&(t.ɵɵtemplate(0,se,2,2,"ng-container",13),t.ɵɵtemplate(1,de,1,0,"ng-template",null,54,t.ɵɵtemplateRefExtractor)),2&e){var i=n.dish,r=t.ɵɵreference(2);t.ɵɵproperty("ngIf",(null==i?null:i.images)&&(null==i.images[0]||null==i.images[0].images?null:i.images[0].images.small))("ngIfElse",r)}}function ce(e,n){1&e&&t.ɵɵelementContainer(0)}function le(e,n){if(1&e&&(t.ɵɵelementStart(0,"div",65),t.ɵɵtext(1),t.ɵɵelementEnd()),2&e){var i=t.ɵɵnextContext().ngIf;t.ɵɵadvance(1),t.ɵɵtextInterpolate1("",1e3*i.weight," гр")}}function me(e,n){1&e&&t.ɵɵelementContainer(0)}var he=function(e,t,n){return{modifier:e,groupId:t,amount:n}};function pe(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵtemplate(1,me,1,0,"ng-container",8),t.ɵɵelementContainerEnd()),2&e){var i=t.ɵɵnextContext(2),r=i.modifier,o=i.groupId,s=i.amount;t.ɵɵnextContext();var d=t.ɵɵreference(8);t.ɵɵadvance(1),t.ɵɵproperty("ngTemplateOutlet",d)("ngTemplateOutletContext",t.ɵɵpureFunction3(2,he,r,o,s))}}function ue(e,n){1&e&&t.ɵɵelementContainer(0)}function fe(e,n){if(1&e&&t.ɵɵtemplate(0,ue,1,0,"ng-container",8),2&e){var i=t.ɵɵnextContext(2),r=i.modifier,o=i.groupId,s=i.amount,d=i.groupAmount,a=i.groupMinAmount,c=i.groupMaxAmount;t.ɵɵnextContext();var l=t.ɵɵreference(6);t.ɵɵproperty("ngTemplateOutlet",l)("ngTemplateOutletContext",t.ɵɵpureFunction6(2,V,r,o,s,d,a,c))}}function ge(e,n){if(1&e&&(t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",57),t.ɵɵelementStart(2,"div",58),t.ɵɵtemplate(3,ce,1,0,"ng-container",8),t.ɵɵelementEnd(),t.ɵɵelementStart(4,"div",59),t.ɵɵelementStart(5,"div",60),t.ɵɵtext(6),t.ɵɵelementEnd(),t.ɵɵtemplate(7,le,2,1,"div",61),t.ɵɵelementEnd(),t.ɵɵelementStart(8,"div",62),t.ɵɵelementStart(9,"div",49),t.ɵɵelementStart(10,"span"),t.ɵɵtext(11),t.ɵɵelementEnd(),t.ɵɵtext(12," ₽ "),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementStart(13,"div",63),t.ɵɵtemplate(14,pe,2,6,"ng-container",13),t.ɵɵtemplate(15,fe,1,9,"ng-template",null,64,t.ɵɵtemplateRefExtractor),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()),2&e){var i=n.ngIf,r=t.ɵɵreference(16),o=t.ɵɵnextContext(),s=o.groupMinAmount,d=o.groupMaxAmount;t.ɵɵnextContext();var a=t.ɵɵreference(2);t.ɵɵadvance(3),t.ɵɵproperty("ngTemplateOutlet",a)("ngTemplateOutletContext",t.ɵɵpureFunction1(8,G,i)),t.ɵɵadvance(3),t.ɵɵtextInterpolate(i.name),t.ɵɵadvance(1),t.ɵɵproperty("ngIf",i.weight),t.ɵɵadvance(2),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(10,C,!i.price)),t.ɵɵadvance(2),t.ɵɵtextInterpolate(i.price),t.ɵɵadvance(3),t.ɵɵproperty("ngIf",s<=1&&1==d)("ngIfElse",r)}}function ve(e,n){if(1&e&&t.ɵɵtemplate(0,ge,17,12,"ng-container",21),2&e){var i=n.modifier;t.ɵɵproperty("ngIf",i.dish)}}var Ce=function(e){return{disabled:e}};function xe(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",66),t.ɵɵelementStart(2,"div",67),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.modifier,r=n.amount;return t.ɵɵnextContext().changeModifierAmount(e,r-1,"minus")})),t.ɵɵtext(3,"-"),t.ɵɵelementEnd(),t.ɵɵelement(4,"input",68,69),t.ɵɵelementStart(6,"div",70),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.modifier,r=n.amount;return t.ɵɵnextContext().changeModifierAmount(e,r+1,"plus")})),t.ɵɵtext(7,"+"),t.ɵɵelementEnd(),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()}if(2&e){var r=n.amount,o=n.groupAmount,s=n.groupMinAmount,d=n.groupMaxAmount;t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(4,Ce,!r&&o>=d)),t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(6,Ce,!r||o<=s)),t.ɵɵadvance(2),t.ɵɵproperty("value",r),t.ɵɵadvance(2),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(8,Ce,o>=d))}}function Me(e,n){if(1&e){var i=t.ɵɵgetCurrentView();t.ɵɵelementContainerStart(0),t.ɵɵelementStart(1,"div",71),t.ɵɵlistener("click",(function(){t.ɵɵrestoreView(i);var e=n.modifier,r=n.amount;return t.ɵɵnextContext().changeModifierAmount(e,r?0:1,"checkbox")})),t.ɵɵelementEnd(),t.ɵɵelementContainerEnd()}if(2&e){var r=n.amount;t.ɵɵadvance(1),t.ɵɵproperty("ngClass",t.ɵɵpureFunction1(1,M,r))}}var Ie=function(){function e(e,n,i){this.cartService=e,this.eventer=n,this.validate=new t.EventEmitter,this.amountDishToAdd=new t.EventEmitter,this.comment=new t.EventEmitter,this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.twoPartsAssembledModifiersIdsByGroupId={},this.imageUrl=i}return e.prototype.ngOnInit=function(){this.checkValid()},e.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifires([],[])},e.prototype.ngOnChanges=function(){var e,t,n,i;if(this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.dish&&this.dish.modifiers){try{for(var r=g(this.dish.modifiers),o=r.next();!o.done;o=r.next()){var s=o.value,d=null;switch(this.modifiers.indexById[s.modifierId]=s,this.modifiers.custom.fixed||this.modifiers.baseList.length||!s.childModifiers||2!=s.childModifiers.length||s.maxAmount!=s.maxAmount||1!=s.maxAmount?s.group&&s.childModifiers&&s.childModifiers.length&&s.childModifiers.find((function(e){return e.dish}))?(d="group",this.modifiers.baseList.push(s),2==s.minAmount&&2==s.maxAmount&&(this.isTwoPartsAssembledTemplate=!0),console.info("Group modifier:",s)):s.dish?(d="single",this.modifiers.baseList.push(s),console.info("Single modifier:",s)):(d="broken",console.warn("Broken modifier:",s)):(d="custom",this.modifiers.custom.fixed=s,console.info("Custom Fixed modifier:",s)),d){case"group":case"custom":this.modifiersValueTree[s.modifierId]={};try{for(var a=(n=void 0,g(s.childModifiers)),c=a.next();!c.done;c=a.next()){var l=c.value;this.modifiers.indexById[l.modifierId]=l,this.modifiersValueTree[s.modifierId][l.modifierId]=l.defaultAmount}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.calculateTotalAmountInGroup(s.modifierId);break;case"single":this.modifiersValueTree.single||(this.modifiersValueTree.single={}),this.modifiers.indexById[s.modifierId]=s,this.modifiersValueTree.single[s.modifierId]=s.defaultAmount}this.checkImagesInModifier(s.modifierId)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this.calculateTotalPrice()}console.log("this.modifiers.indexById",this.modifiers.indexById)},e.prototype.calculateTotalAmountInGroup=function(e){if("single"!=e)return this.modifiers.indexById[e].totalAmount=Object.values(this.modifiersValueTree[e]).reduce((function(e,t){return e+t})),this.modifiers.indexById[e].totalAmount},e.prototype.checkImagesInModifier=function(e){var t=this.modifiers.indexById[e];this.modifiers.indexById[e].imagesIsset=!!(t.dish&&t.dish.images&&t.dish.images.length),this.modifiers.indexById[e].childImagesIsset=!!this.modifiers.indexById[e].childModifiers.find((function(e){return!!(e&&e.dish&&e.dish.images&&e.dish.images.length)}))},e.prototype.calculateTotalPrice=function(){var e=this.dish.price||0;for(var t in this.modifiersValueTree)for(var n in this.modifiersValueTree[t]){var i=this.modifiersValueTree[t][n];if(i){var r=this.modifiers.indexById[n];r&&r.dish&&r.dish.price&&(e+=r.dish.price*i)}}this.totalPrice=e,this.setModifiers()},e.prototype.getModifiersIds=function(e){return{groupId:e.dish&&e.dish.groupId?e.dish.groupId:void 0,modifierId:e.modifierId}},e.prototype.selectTwoPartsAssembledModifier=function(e){var t=this.getModifiersIds(e),n=t.groupId,i=void 0===n?"single":n,o=t.modifierId,s=(e.minAmount,e.maxAmount,this.modifiers.indexById[i]||{}),d=(s.minAmount,s.maxAmount),a=void 0===d?0:d,c=this.modifiersValueTree[i][o],l=c?0:1;this.twoPartsAssembledModifiersIdsByGroupId[i]||(this.twoPartsAssembledModifiersIdsByGroupId[i]=[]);var m=this.modifiers.indexById[i].totalAmount-c+l;if(m>a){if(!this.twoPartsAssembledModifiersIdsByGroupId[i].length)return console.warn("Limit: max "+a+". Current "+m),void this.eventer.emitMessageEvent(new r.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[i].group.name+'" - не более '+a));for(var h in this.modifiersValueTree[i])this.modifiersValueTree[i][h]=0;this.twoPartsAssembledModifiersIdsByGroupId[i]=this.twoPartsAssembledModifiersIdsByGroupId[i].slice(1,2),this.modifiersValueTree[i][this.twoPartsAssembledModifiersIdsByGroupId[i][0]]=1}else 0===m&&(this.twoPartsAssembledModifiersIdsByGroupId[i]=[]);l&&!this.twoPartsAssembledModifiersIdsByGroupId[i].find((function(e){return e==o}))&&this.twoPartsAssembledModifiersIdsByGroupId[i].push(o),this.modifiersValueTree[i][o]=l,this.calculateTotalAmountInGroup(i),this.calculateTotalPrice()},e.prototype.changeModifierAmount=function(e,t,n){if(!(t<0)){var i=this.getModifiersIds(e),o=i.groupId,s=void 0===o?"single":o,d=i.modifierId,a=e.minAmount,c=e.maxAmount,l=this.modifiers.indexById[s]||{},m=l.minAmount,h=void 0===m?0:m,p=l.maxAmount,u=void 0===p?0:p,f=this.modifiersValueTree[s][d];if("checkbox"==n&&"single"!==s){if(h<=1&&1==u){if(t<h)return;for(var g in this.modifiersValueTree[s])this.modifiersValueTree[s][g]=0;this.calculateTotalAmountInGroup(s)}if(0==t)return void this.calculateTotalPrice()}if(h||u){var v=this.modifiers.indexById[s].totalAmount-f+t;if(v<h)return console.warn("Limit: min "+h+". Current "+v),void this.eventer.emitMessageEvent(new r.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[s].group.name+'" - не менее '+h));if(v>u)return console.warn("Limit: max "+u+". Current "+v),void this.eventer.emitMessageEvent(new r.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[s].group.name+'" - не более '+u))}if(a||c){if(t<a)switch(n){case"plus":t=a;break;case"minus":t=0}t>c&&(t=c)}this.modifiersValueTree[s][d]=t,this.calculateTotalAmountInGroup(s),this.calculateTotalPrice()}},e.prototype.setModifiers=function(){var e=[];for(var t in this.modifiersValueTree)for(var n in this.modifiersValueTree[t]){var i=this.modifiersValueTree[t][n];i&&e.push({id:n,amount:i,groupId:"single"!==t?t:void 0})}e.length&&(this.checkValid(),this.cartService.setModifires(e,[]))},e.prototype.checkValid=function(){var e=!0;for(var t in this.modifiersValueTree){var n=this.modifiers.indexById[t];if(n.required){var i=this.calculateTotalAmountInGroup(t);i<n.minAmount&&(e=!1,console.warn("Modifier "+t+" min amount: "+n.minAmount)),i>n.maxAmount&&(e=!1,console.warn("Modifier "+t+" max amount: "+n.maxAmount))}}this.validate.emit(e)},e}();Ie.ɵfac=function(e){return new(e||Ie)(t.ɵɵdirectiveInject(s),t.ɵɵdirectiveInject(r.EventerService),t.ɵɵdirectiveInject("ImageUrl"))},Ie.ɵcmp=t.ɵɵdefineComponent({type:Ie,selectors:[["dish-calc"]],inputs:{dish:"dish",amount:"amount",selectedModifiers:"selectedModifiers"},outputs:{validate:"validate",amountDishToAdd:"amountDishToAdd",comment:"comment"},features:[t.ɵɵNgOnChangesFeature],decls:9,vars:1,consts:[["class","ng-cart-dish-calc",3,"ngClass",4,"ngIf"],["dishImageTemplate",""],["modifierTemplate",""],["modifierCounterTemplate",""],["modifierCheckboxTemplate",""],[1,"ng-cart-dish-calc",3,"ngClass"],[1,"dish"],[1,"dish-image-box"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"dish-description-box"],[1,"dish-name"],[1,"dish-ingredients"],[1,"dish-price-box"],[4,"ngIf","ngIfElse"],["modifierFixedTemplate",""],["class","modifiers",4,"ngIf"],[1,"result"],[1,"text"],[1,"price"],["class","comment",4,"ngIf"],[1,"price",3,"ngClass"],[4,"ngIf"],[1,"modifier-fixed"],[4,"ngFor","ngForOf"],[1,"item",3,"ngClass","click"],[1,"modifiers"],[1,"modifier-group"],["class","modifier-header",4,"ngIf"],[1,"modifier-box",3,"ngClass"],[1,"modifier-header"],["class","modifier-name",4,"ngIf"],["class","modifier-description",4,"ngIf"],[1,"modifier-name"],[1,"modifier-description"],[4,"ngIf","ngIfThen","ngIfElse"],["groupTemplate",""],["twoPartsAssembledTemplate",""],[1,"modifier-children",3,"ngClass"],[1,"two-parts-assembled"],[1,"two-parts-assembled-header",3,"ngClass"],[1,"two-parts-assembled-body"],[1,"two-parts-assembled-body-name"],[1,"two-parts-assembled-body-list"],[1,"selected-dish"],[1,"title"],[1,"image-box"],["class","two-parts-assembled-body-list-dish",3,"ngClass","click",4,"ngIf"],[1,"two-parts-assembled-body-list-dish",3,"ngClass","click"],[1,"dish-price"],[3,"ngClass"],[1,"comment"],[1,"input-box"],["type","text","placeholder","",3,"keyup"],["commentInput",""],["imgPlaceholder",""],[1,"dish-image"],[1,"dish-image-placeholder"],[1,"modifier-dish"],[1,"modifier-dish-image-box"],[1,"modifier-dish-description-box"],[1,"modifier-dish-name"],["class","modifier-dish-weight",4,"ngIf"],[1,"modifier-dish-price-box"],[1,"modifier-dish-action-box"],["counterTemplate",""],[1,"modifier-dish-weight"],[1,"modifier-counter",3,"ngClass"],["onselectstart","return false;",1,"minus",3,"ngClass","click"],["readonly","",3,"value"],["input",""],["onselectstart","return false;",1,"plus",3,"ngClass","click"],[1,"modifier-checkbox",3,"ngClass","click"]],template:function(e,n){1&e&&(t.ɵɵtemplate(0,oe,22,14,"div",0),t.ɵɵtemplate(1,ae,3,2,"ng-template",null,1,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(3,ve,1,1,"ng-template",null,2,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(5,xe,8,10,"ng-template",null,3,t.ɵɵtemplateRefExtractor),t.ɵɵtemplate(7,Me,2,3,"ng-template",null,4,t.ɵɵtemplateRefExtractor)),2&e&&t.ɵɵproperty("ngIf",n.dish)},directives:[o.NgIf,o.NgClass,o.NgTemplateOutlet,o.NgForOf],styles:['.dish[_ngcontent-%COMP%]{align-items:flex-start;border-bottom:2px solid #969696;display:flex;padding-bottom:34px}.dish[_ngcontent-%COMP%]   .dish-image-box[_ngcontent-%COMP%]{background-color:#eee;background-size:50%;box-sizing:border-box;height:170px;position:relative;text-align:center;width:250px}.dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]{align-items:stretch;box-sizing:border-box;display:flex;flex-direction:column;height:170px;margin-left:34px;padding:5px 0 0}.dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-name[_ngcontent-%COMP%]{color:#0a0909;font-size:28px;font-weight:700;letter-spacing:2.4px;line-height:32px}.dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-ingredients[_ngcontent-%COMP%]{color:#000;flex-grow:1;font-size:15px;line-height:17px;margin-top:15px;overflow:hidden}.dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-price-box[_ngcontent-%COMP%]{align-items:center;display:flex;font-size:20px;font-weight:700;height:45px;justify-content:space-between;line-height:23px;margin-right:49px}.ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]{border:none;margin-left:0;padding-bottom:0}.ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .dish-image-box[_ngcontent-%COMP%]{display:none}.ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]{height:auto;width:100%}.ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-name[_ngcontent-%COMP%]{color:#0a0909;font-size:28px;font-weight:700;letter-spacing:2.4px;line-height:32px;text-align:center;text-transform:uppercase}.ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-ingredients[_ngcontent-%COMP%], .ng-cart-dish-calc-two-parts-assembled[_ngcontent-%COMP%]   .dish[_ngcontent-%COMP%]   .dish-description-box[_ngcontent-%COMP%]   .dish-price-box[_ngcontent-%COMP%]{display:none}.dish-image[_ngcontent-%COMP%]{background-position:top;background-repeat:no-repeat;background-size:cover;border-radius:0;height:100%;width:250px}.result[_ngcontent-%COMP%]{color:#0a0909;font-size:24px;font-weight:700;line-height:28px;margin-top:49px;text-align:right}.result[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{margin-left:76px}.comment[_ngcontent-%COMP%]{padding-bottom:15px}.comment[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;font-weight:500;line-height:23px;margin:30px 0 20px}.comment[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]{margin-top:10px}.comment[_ngcontent-%COMP%]   .input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:2px solid #969696;border-radius:15px;box-sizing:border-box;color:#969696;font-size:20px;font-style:italic;font-weight:400;height:45px;line-height:45px;padding:0 20px}.modifiers[_ngcontent-%COMP%]   .modifier-group[_ngcontent-%COMP%]{border-bottom:2px solid #969696;margin-top:25px;padding-bottom:25px}.modifiers[_ngcontent-%COMP%]   .modifier-header[_ngcontent-%COMP%]{margin-bottom:25px}.modifiers[_ngcontent-%COMP%]   .modifier-header[_ngcontent-%COMP%]   .modifier-name[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;font-weight:500;line-height:23px}.modifiers[_ngcontent-%COMP%]   .modifier-header[_ngcontent-%COMP%]   .modifier-description[_ngcontent-%COMP%]{color:#0a0909;font-size:15px;line-height:17px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]{align-items:center;box-sizing:border-box;display:flex;height:100px;justify-content:center;margin-bottom:2px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-image-box[_ngcontent-%COMP%]{background-color:#fff;background-size:50%;box-sizing:border-box;height:100px;margin-right:28px;position:relative;text-align:center;width:100px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-image-box[_ngcontent-%COMP%]   .dish-image[_ngcontent-%COMP%]{background-position:50%;background-size:contain;height:100%;width:100%}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-description-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1;justify-content:center}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-description-box[_ngcontent-%COMP%]   .modifier-dish-name[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;font-weight:500;line-height:23px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-description-box[_ngcontent-%COMP%]   .modifier-dish-weight[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;line-height:23px;margin-top:10px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-price-box[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;font-weight:700;line-height:23px;margin-right:105px}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-price-box[_ngcontent-%COMP%]   .zero-price[_ngcontent-%COMP%]{display:none}.modifiers[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]   .modifier-dish-action-box[_ngcontent-%COMP%]{display:flex;justify-content:center;width:151px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]{align-items:center;border-bottom:2px solid #969696;display:flex;height:230px;justify-content:center;opacity:1;overflow:hidden;padding-bottom:28px;transition:all .5s ease 0s}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header.empty[_ngcontent-%COMP%]{border-bottom:none;height:0;opacity:0}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-end;width:50%}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#0a0909;font-size:21px;line-height:25px;margin-right:24px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]{height:200px;overflow:hidden;width:100px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]   .dish-image[_ngcontent-%COMP%]{height:100%;width:200%}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]:nth-child(2){flex-direction:row-reverse}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]:nth-child(2)   .title[_ngcontent-%COMP%]{margin-left:24px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-header[_ngcontent-%COMP%]   .selected-dish[_ngcontent-%COMP%]:nth-child(2)   .image-box[_ngcontent-%COMP%]{direction:rtl}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-name[_ngcontent-%COMP%]{color:#0a0909;font-size:20px;font-weight:500;line-height:23px;padding:20px 0}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]{-ms-grid-columns:1fr 1fr 1fr;display:-ms-grid;display:grid;grid-column-gap:30px;grid-row-gap:24px;grid-template-columns:1fr 1fr 1fr;margin-top:30px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish[_ngcontent-%COMP%]{align-items:center;border:1.5px solid hsla(0,0%,100%,0);box-sizing:border-box;color:#0a0909;cursor:pointer;display:flex;flex-direction:column}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish.selected[_ngcontent-%COMP%]{border:1.5px solid #0a0909;border-radius:15px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish[_ngcontent-%COMP%]   .dish-name[_ngcontent-%COMP%]{font-size:17px;font-weight:500;letter-spacing:2.4px;line-height:20px;padding:0 5px;text-align:center;text-transform:uppercase}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish[_ngcontent-%COMP%]   .dish-price[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:23px;padding:5px 0 10px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]{border-radius:15px 15px 0 0;height:228px;width:228px}.two-parts-assembled[_ngcontent-%COMP%]   .two-parts-assembled-body[_ngcontent-%COMP%]   .two-parts-assembled-body-list[_ngcontent-%COMP%]   .two-parts-assembled-body-list-dish[_ngcontent-%COMP%]   .image-box[_ngcontent-%COMP%]   .dish-image[_ngcontent-%COMP%]{border-radius:15px 15px 0 0;height:100%;width:100%}.modifier-fixed[_ngcontent-%COMP%]{align-items:stretch;border:2px solid #767676;border-radius:15px;box-sizing:border-box;display:flex;height:45px}.modifier-fixed[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{align-items:center;color:#767676;display:flex;font-size:20px;font-weight:500;height:45px;justify-content:center;line-height:23px;margin-top:-2px;width:142px}.modifier-fixed[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:first-child{margin-left:-2px}.modifier-fixed[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:last-child{margin-right:-2px}.modifier-fixed[_ngcontent-%COMP%]   .item.selected[_ngcontent-%COMP%]{background:#0a0909;border-radius:15px;color:#fff}.modifier-fixed[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:not(.selected){cursor:pointer}.modifier-checkbox[_ngcontent-%COMP%]{align-items:center;background:#e0e0e0;border-radius:15px;cursor:pointer;display:flex;height:50px;justify-content:center;width:50px}.modifier-checkbox.selected[_ngcontent-%COMP%]:after{content:url("data:image/svg+xml; base64, PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgMTMuNUwxMS4zMjMxIDI2TDI2IDIiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMy41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==")}.modifier-counter[_ngcontent-%COMP%]{align-items:center;background:#e0e0e0;border:none;border-radius:15px;display:flex;height:50px;position:relative;width:151px}.modifier-counter.disabled[_ngcontent-%COMP%]{opacity:.3}.modifier-counter[_ngcontent-%COMP%]:not(.disabled)   .minus.disabled[_ngcontent-%COMP%], .modifier-counter[_ngcontent-%COMP%]:not(.disabled)   .plus.disabled[_ngcontent-%COMP%]{cursor:default;opacity:.15}.modifier-counter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:transparent;border:none;font-weight:500;padding:0;width:100%}.modifier-counter[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%], .modifier-counter[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%], .modifier-counter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#0a0909;font-size:18px;height:50px;line-height:50px;text-align:center}.modifier-counter[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%], .modifier-counter[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{cursor:pointer;display:block;font-style:normal;font-weight:700;padding:0 30px;position:absolute;top:0}.modifier-counter[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]:hover, .modifier-counter[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]:hover{color:#000}.modifier-counter[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]:active, .modifier-counter[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]:active{color:#cc0009}.modifier-counter[_ngcontent-%COMP%]   .minus.loading[_ngcontent-%COMP%], .modifier-counter[_ngcontent-%COMP%]   .plus.loading[_ngcontent-%COMP%]{opacity:.2}.modifier-counter[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{left:0}.modifier-counter[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{right:0}.without-images[_ngcontent-%COMP%]   .modifier-dish-image-box[_ngcontent-%COMP%]{height:70px!important}.without-images[_ngcontent-%COMP%]   .modifier-dish[_ngcontent-%COMP%]{height:70px}']});var be=[o.CommonModule],ye=function(){};ye.ɵmod=t.ɵɵdefineNgModule({type:ye}),ye.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||ye)},providers:[],imports:[[be]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(ye,{declarations:[d,a,l,p,m,f,u,c,Ie],imports:[o.CommonModule],exports:[d,a,l,p,m,f,u,c,Ie]}),e.AddDishToCartDirective=d,e.AmountCartDirective=a,e.CheckoutDirective=c,e.DeleteFromCartDirective=l,e.DishCalcComponent=Ie,e.DishCalcDirective=m,e.ModifiresDirective=h,e.NgRestoCartModule=ye,e.NgRestoCartService=s,e.OrderCartUserDirective=p,e.SetAmountDirective=u,e.SetDishCommentDirective=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=webresto-ng-cart.umd.min.js.map