!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("\0commonjsHelpers.js"),require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@webresto/ng-core"),require("\0commonjs-proxy-@angular/core"),require("\0commonjs-proxy-rxjs"),require("\0commonjs-proxy-rxjs/operators"),require("\0commonjs-proxy-@webresto/ng-core"),require("\0commonjs-proxy-../services/ng-restocart.service"),require("\0commonjs-proxy-../../services/ng-restocart.service"),require("@angular/common"),require("\0commonjs-proxy-@angular/common"),require("\0commonjs-proxy-./directives/add-dish-to-cart.directive"),require("\0commonjs-proxy-./directives/amount-cart.directive"),require("\0commonjs-proxy-./directives/delete-from-cart.directive"),require("\0commonjs-proxy-./directives/order-cart-user.directive"),require("\0commonjs-proxy-./directives/set-amount.directive"),require("\0commonjs-proxy-./directives/dish-calc.directive"),require("\0commonjs-proxy-./directives/checkout.directive"),require("\0commonjs-proxy-./directives/set-dish-comment.directive"),require("\0commonjs-proxy-./components/dish-calc/dish-calc.component"),require("\0commonjs-proxy-./components/dish-calc-ln/dish-calc-ln.component"),require("\0commonjs-proxy-./lib/services/ng-restocart.service"),require("\0commonjs-proxy-./lib/ng-cart.module"),require("\0commonjs-proxy-./public_api"),require("\0commonjs-proxy-./lib/components/dish-calc-ln/dish-calc-ln.component"),require("\0commonjs-proxy-./lib/components/dish-calc/dish-calc.component"),require("\0commonjs-proxy-./lib/directives/add-dish-to-cart.directive"),require("\0commonjs-proxy-./lib/directives/amount-cart.directive"),require("\0commonjs-proxy-./lib/directives/checkout.directive"),require("\0commonjs-proxy-./lib/directives/delete-from-cart.directive"),require("\0commonjs-proxy-./lib/directives/dish-calc.directive"),require("\0commonjs-proxy-./lib/directives/order-cart-user.directive"),require("\0commonjs-proxy-./lib/directives/set-amount.directive"),require("\0commonjs-proxy-./lib/directives/set-dish-comment.directive")):"function"==typeof define&&define.amd?define("@webresto/ng-cart",["\0commonjsHelpers.js","@angular/core","rxjs","rxjs/operators","@webresto/ng-core","\0commonjs-proxy-@angular/core","\0commonjs-proxy-rxjs","\0commonjs-proxy-rxjs/operators","\0commonjs-proxy-@webresto/ng-core","\0commonjs-proxy-../services/ng-restocart.service","\0commonjs-proxy-../../services/ng-restocart.service","@angular/common","\0commonjs-proxy-@angular/common","\0commonjs-proxy-./directives/add-dish-to-cart.directive","\0commonjs-proxy-./directives/amount-cart.directive","\0commonjs-proxy-./directives/delete-from-cart.directive","\0commonjs-proxy-./directives/order-cart-user.directive","\0commonjs-proxy-./directives/set-amount.directive","\0commonjs-proxy-./directives/dish-calc.directive","\0commonjs-proxy-./directives/checkout.directive","\0commonjs-proxy-./directives/set-dish-comment.directive","\0commonjs-proxy-./components/dish-calc/dish-calc.component","\0commonjs-proxy-./components/dish-calc-ln/dish-calc-ln.component","\0commonjs-proxy-./lib/services/ng-restocart.service","\0commonjs-proxy-./lib/ng-cart.module","\0commonjs-proxy-./public_api","\0commonjs-proxy-./lib/components/dish-calc-ln/dish-calc-ln.component","\0commonjs-proxy-./lib/components/dish-calc/dish-calc.component","\0commonjs-proxy-./lib/directives/add-dish-to-cart.directive","\0commonjs-proxy-./lib/directives/amount-cart.directive","\0commonjs-proxy-./lib/directives/checkout.directive","\0commonjs-proxy-./lib/directives/delete-from-cart.directive","\0commonjs-proxy-./lib/directives/dish-calc.directive","\0commonjs-proxy-./lib/directives/order-cart-user.directive","\0commonjs-proxy-./lib/directives/set-amount.directive","\0commonjs-proxy-./lib/directives/set-dish-comment.directive"],i):(e.webresto=e.webresto||{},e.webresto["ng-cart"]=i(null,e.ng.core,e.rxjs,e.rxjs.operators,0,null,null,null,null,null,null,e.ng.common,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null))}(this,function(e,i,t,r,n,d,s,a,v,o,c,l,m,h,p,u,f,g,x,b,y,I,w,M,C,T,A,P,D,k,j,O,E,S,_,B){"use strict";d=d&&d.hasOwnProperty("default")?d["default"]:d,s=s&&s.hasOwnProperty("default")?s["default"]:s,a=a&&a.hasOwnProperty("default")?a["default"]:a,v=v&&v.hasOwnProperty("default")?v["default"]:v,o=o&&o.hasOwnProperty("default")?o["default"]:o,c=c&&c.hasOwnProperty("default")?c["default"]:c,m=m&&m.hasOwnProperty("default")?m["default"]:m,h=h&&h.hasOwnProperty("default")?h["default"]:h,p=p&&p.hasOwnProperty("default")?p["default"]:p,u=u&&u.hasOwnProperty("default")?u["default"]:u,f=f&&f.hasOwnProperty("default")?f["default"]:f,g=g&&g.hasOwnProperty("default")?g["default"]:g,x=x&&x.hasOwnProperty("default")?x["default"]:x,b=b&&b.hasOwnProperty("default")?b["default"]:b,y=y&&y.hasOwnProperty("default")?y["default"]:y,I=I&&I.hasOwnProperty("default")?I["default"]:I,w=w&&w.hasOwnProperty("default")?w["default"]:w,M=M&&M.hasOwnProperty("default")?M["default"]:M,C=C&&C.hasOwnProperty("default")?C["default"]:C,T=T&&T.hasOwnProperty("default")?T["default"]:T,A=A&&A.hasOwnProperty("default")?A["default"]:A,P=P&&P.hasOwnProperty("default")?P["default"]:P,D=D&&D.hasOwnProperty("default")?D["default"]:D,k=k&&k.hasOwnProperty("default")?k["default"]:k,j=j&&j.hasOwnProperty("default")?j["default"]:j,O=O&&O.hasOwnProperty("default")?O["default"]:O,E=E&&E.hasOwnProperty("default")?E["default"]:E,S=S&&S.hasOwnProperty("default")?S["default"]:S,_=_&&_.hasOwnProperty("default")?_["default"]:_,B=B&&B.hasOwnProperty("default")?B["default"]:B;var z=function(e,i){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)i.hasOwnProperty(t)&&(e[t]=i[t])})(e,i)};var V=function(){return V=Object.assign||function V(e){for(var i,t=1,r=arguments.length;t<r;t++)for(var n in i=arguments[t])Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);return e},V.apply(this,arguments)};function L(e){var i="function"==typeof Symbol&&Symbol.iterator,t=i&&e[i],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function G(e,i){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,n,o=t.call(e),s=[];try{for(;(void 0===i||0<i--)&&!(r=o.next()).done;)s.push(r.value)}catch(d){n={error:d}}finally{try{r&&!r.done&&(t=o["return"])&&t.call(o)}finally{if(n)throw n.error}}return s}function H(e){return this instanceof H?(this.v=e,this):new H(e)}var F=Object.freeze({__extends:function(e,i){function t(){this.constructor=e}z(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)},get __assign(){return V},__rest:function(e,i){var t={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,n=Object.getOwnPropertySymbols(e);r<n.length;r++)i.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]]);return t},__decorate:function(e,i,t,r){var n,o=arguments.length,s=o<3?i:null===r?r=Object.getOwnPropertyDescriptor(i,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,i,t,r);else for(var d=e.length-1;0<=d;d--)(n=e[d])&&(s=(o<3?n(s):3<o?n(i,t,s):n(i,t))||s);return 3<o&&s&&Object.defineProperty(i,t,s),s},__param:function(t,r){return function(e,i){r(e,i,t)}},__metadata:function(e,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,i)},__awaiter:function(e,i,d,a){return new(d=d||Promise)(function(t,r){function n(e){try{s(a.next(e))}catch(i){r(i)}}function o(e){try{s(a["throw"](e))}catch(i){r(i)}}function s(e){var i;e.done?t(e.value):((i=e.value)instanceof d?i:new d(function(e){e(i)})).then(n,o)}s((a=a.apply(e,i||[])).next())})},__generator:function(t,r){var n,o,s,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:i(0),"throw":i(1),"return":i(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function i(i){return function(e){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;d;)try{if(n=1,o&&(s=2&e[0]?o["return"]:e[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return d.label++,{value:e[1],done:!1};case 5:d.label++,o=e[1],e=[0];continue;case 7:e=d.ops.pop(),d.trys.pop();continue;default:if(!(s=0<(s=d.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){d=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){d.label=e[1];break}if(6===e[0]&&d.label<s[1]){d.label=s[1],s=e;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(e);break}s[2]&&d.ops.pop(),d.trys.pop();continue}e=r.call(t,d)}catch(i){e=[6,i],o=0}finally{n=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([i,e])}}},__createBinding:function(e,i,t,r){r===undefined&&(r=t),e[r]=i[t]},__exportStar:function(e,i){for(var t in e)"default"===t||i.hasOwnProperty(t)||(i[t]=e[t])},__values:L,__read:G,__spread:function(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(G(arguments[i]));return e},__spreadArrays:function(){for(var e=0,i=0,t=arguments.length;i<t;i++)e+=arguments[i].length;for(var r=Array(e),n=0,i=0;i<t;i++)for(var o=arguments[i],s=0,d=o.length;s<d;s++,n++)r[n]=o[s];return r},__await:H,__asyncGenerator:function(e,i,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(e,i||[]),o=[],s={};return r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s;function r(r){n[r]&&(s[r]=function(t){return new Promise(function(e,i){1<o.push([r,t,e,i])||d(r,t)})})}function d(e,i){try{(t=n[e](i)).value instanceof H?Promise.resolve(t.value.v).then(a,c):l(o[0][2],t)}catch(r){l(o[0][3],r)}var t}function a(e){d("next",e)}function c(e){d("throw",e)}function l(e,i){e(i),o.shift(),o.length&&d(o[0][0],o[0][1])}},__asyncDelegator:function(r){var n,e={};return i("next"),i("throw",function(e){throw e}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,t){e[i]=r[i]?function(e){return(n=!n)?{value:H(r[i](e)),done:"return"===i}:t?t(e):e}:t}},__asyncValues:function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=a[Symbol.asyncIterator];return i?i.call(a):(a=L(a),e={},t("next"),t("throw"),t("return"),e[Symbol.asyncIterator]=function(){return this},e);function t(d){e[d]=a[d]&&function(s){return new Promise(function(e,i){var t,r,n,o;s=a[d](s),t=e,r=i,n=s.done,o=s.value,Promise.resolve(o).then(function(e){t({value:e,done:n})},r)})}}},__makeTemplateObject:function(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e},__importStar:function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(i[t]=e[t]);return i["default"]=e,i},__importDefault:function(e){return e&&e.__esModule?e:{"default":e}},__classPrivateFieldGet:function(e,i){if(!i.has(e))throw new TypeError("attempted to get private field on non-instance");return i.get(e)},__classPrivateFieldSet:function(e,i,t){if(!i.has(e))throw new TypeError("attempted to set private field on non-instance");return i.set(e,t),t}}),q=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=d,r=v,n=(o.prototype.initialStorage=function(){var i=this;this.cartID=this.getCartId(),this.cartID&&this.net.get("/cart?cartId="+this.cartID).pipe(a.tap(function(e){"ORDER"==e.state&&s.throwError(new Error("Cart in order state"))})).subscribe(function(e){return i.cart.next(e.cart)},function(e){return i.removeCartId()})},o.prototype.getCartId=function(){return localStorage.getItem("cartID")},o.prototype.addDishToCart=function(e){var i=this;this.messages.length?this.messages.forEach(function(e){i.eventer.emitMessageEvent(e)}):this.net.put("/cart/add",e).subscribe(function(e){i.setCartId(e.cart.cartId),i.cart.next(e.cart),i.cartID=e.cart.cartId},function(e){})},o.prototype.addDishToCart$=function(e){var i=this;return this.messages.length?(this.messages.forEach(function(e){i.eventer.emitMessageEvent(e)}),s.of(null)):this.net.put("/cart/add",e).pipe(a.tap(function(e){i.setCartId(e.cart.cartId),i.cart.next(e.cart),i.cartID=e.cart.cartId}))},o.prototype.setDishCountToCart=function(e,i){var t=this;this.net.post("/cart/set",{dishId:e,cartId:this.cartID,amount:i}).subscribe(function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId},function(e){})},o.prototype.setDishComment=function(e,i){var t=this;return this.net.post("/cart/setcomment",{dishId:e,cartId:this.cartID,comment:i}).pipe(a.tap(function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId},function(e){t.eventer.emitMessageEvent(new v.EventMessage("error","Ошибка","Не удалось изменить коментарий"))}))},o.prototype.removeDishFromCart$=function(e,i){var t=this;return this.net.put("/cart/remove",{dishId:e,cartId:this.cartID,amount:i}).pipe(a.tap(function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId}))},o.prototype.removeDishFromCart=function(e,i){var t=this;this.net.put("/cart/remove",{dishId:e,cartId:this.cartID,amount:i}).subscribe(function(e){t.setCartId(e.cart.cartId),t.cart.next(e.cart),t.cartID=e.cart.cartId},function(e){})},o.prototype.checkoutCart=function(e){var i={cartId:this.cartID,address:{streetId:e.street.id,home:e.house,housing:e.housing,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:e.phone,name:e.name,mail:e.email||undefined}};return this.orderCart(i)},o.prototype.orderCart=function(e){var i=this;return this.net.post("/order",e).pipe(a.tap(function(e){i.setCartId(e.cart.cartId),i.cart.next(e.cart),i.cartID=e.cart.cartId},function(e){console.log("Ошибка оформления!",e),e.error&&e.error.cart&&(i.setCartId(e.error.cart.cartId),i.cart.next(e.error.cart),i.cartID=e.error.cart.cartId)}))},o.prototype.checkStreetV2=function(e){var i=this;return this.net.post("/check",e).pipe(a.tap(function(e){i.setCartId(e.cart.cartId),i.cart.next(e.cart),i.cartID=e.cart.cartId},function(e){console.error(e)}))},o.prototype.checkStreet=function(e){var i=this;this.net.post("/check",e).subscribe(function(e){i.setCartId(e.cart.cartId),i.cart.next(e.cart),i.cartID=e.cart.cartId,e.message&&i.eventer.emitMessageEvent(new v.EventMessage(e.message.type,e.message.title,e.message.body))},function(e){e.error&&e.error.cart&&(i.setCartId(e.error.cart.cartId),i.cart.next(e.error.cart),i.cartID=e.error.cart.cartId)})},o.prototype.setCartId=function(e){localStorage.setItem("cartID",e)},o.prototype.removeCartId=function(){localStorage.removeItem("cartID")},o.prototype.userCart=function(){return this.cart},o.prototype.setModifires=function(e,i){this.modifires.next(e),i&&this.modifiresMessage.next(i)},o.prototype.getModifires=function(){return this.modifires},o.decorators=[{type:d.Injectable,args:[{providedIn:"root"}]}],o.ctorParameters=function(){return[{type:v.NetService},{type:v.EventerService}]},o.ngInjectableDef=t.defineInjectable({factory:function(){return new o(t.inject(r.NetService),t.inject(r.EventerService))},token:o,providedIn:"root"}),o);function o(e,i){var t=this;this.net=e,this.eventer=i,this.OrderFormChange=new s.BehaviorSubject(null),this.cart=new s.BehaviorSubject({}),this.modifires=new s.BehaviorSubject([]),this.modifiresMessage=new s.BehaviorSubject([]),this.initialStorage(),this.modifiresMessage.subscribe(function(e){return t.messages=e})}i.NgRestoCartService=n});e.unwrapExports(q);q.NgRestoCartService;var R=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){this.addDishToCart(this.dish.id,this.amountDish)},r.prototype.addDishToCart=function(e,i){var t=this,r={dishId:e,amount:i,cartId:undefined,modifiers:this.modifires,comment:this.comment,replace:!!this.replaceCartDishId||undefined,cartDishId:this.replaceCartDishId};this.cart.cartId&&(r.cartId=this.cart.cartId),this.loading.emit(!0),this.cartService.addDishToCart$(r).subscribe(function(e){return t.success.emit(!0)},function(e){return t.error.emit(e)},function(){t.loading.emit(!1)})},r.decorators=[{type:d.Directive,args:[{selector:"[addToCart]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={dish:[{type:d.Input}],amountDish:[{type:d.Input}],comment:[{type:d.Input}],replaceCartDishId:[{type:d.Input}],loading:[{type:d.Output}],success:[{type:d.Output}],error:[{type:d.Output}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){var i=this;this.cartService=e,this.loading=new d.EventEmitter,this.success=new d.EventEmitter,this.error=new d.EventEmitter,this.cartService.userCart().subscribe(function(e){return i.cart=e}),this.cartService.getModifires().subscribe(function(e){return i.modifires=e})}i.AddDishToCartDirective=t});e.unwrapExports(R);R.AddDishToCartDirective;var N=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.decorators=[{type:d.Directive,args:[{selector:"[amountCart]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService},{type:d.Renderer2},{type:d.ElementRef}]},r);function r(e,i,t){var r=this;this.cartService=e,this.renderer=i,this.el=t,this.amount="0",this.renderer.setProperty(this.el.nativeElement,"innerHTML",this.amount),this.cartService.userCart().subscribe(function(e){r.cart=e,r.amount=e.dishesCount||0,r.renderer.setProperty(r.el.nativeElement,"innerHTML",r.amount)})}i.AmountCartDirective=t});e.unwrapExports(N);N.AmountCartDirective;var Z=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){this.cartService.removeDishFromCart(this.dish.id,this.amountDish)},r.decorators=[{type:d.Directive,args:[{selector:"[deleteFromCart]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={dish:[{type:d.Input}],amountDish:[{type:d.Input}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){var i=this;this.cartService=e,this.cartService.userCart().subscribe(function(e){return i.cart=e})}i.DeleteFromCartDirective=t});e.unwrapExports(Z);Z.DeleteFromCartDirective;var W=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){this.order(this.orderCart.value),console.log(this.orderCart.value)},r.prototype.ngAfterViewInit=function(){var i=this;setTimeout(function(){i.cartService.userCart().subscribe(function(e){i.cart&&i.orderCart.valid&&i.cart.cartTotal!=e.cartTotal&&0<e.cartTotal&&i.checkStreet(i.orderCart.value),i.cart=e})},100),setTimeout(function(){i.checkerFields.next(i.checkForFields(i.orderCart._directives,i.requiredFields))},100),this.checkerFields.subscribe(function(e){e&&(i.orderCart.controls.street.valueChanges.subscribe(function(e){"object"==typeof e&&setTimeout(function(){i.orderCart.controls.house.valid&&(i.orderCart.value.name=i.orderCart.value.name||"Неуказано",i.orderCart.value.phone=i.orderCart.value.phone||"78888888888",i.checkStreet(i.orderCart.value))},100)}),i.orderCart.controls.house.valueChanges.subscribe(function(e){setTimeout(function(){i.orderCart.controls.street.valid&&(i.orderCart.value.name=i.orderCart.value.name||"Неуказано",i.orderCart.value.phone=i.orderCart.value.phone||"78888888888",i.checkStreet(i.orderCart.value))},100)}))})},r.prototype.checkForFields=function(e,i){var t={},r=[];return e.forEach(function(e){t[e.name]=!0}),i.forEach(function(e){t.hasOwnProperty(e)||r.push(e)}),r.length<=0||(console.error("У формы отсутсвуют следующие обязательные для корректной работы модуля поля:",r),!1)},r.prototype.order=function(e){var i,t,r;this.checkForFields(this.orderCart._directives,this.requiredFields)&&(t=void 0,i=e.comment||"Не указан",t=e.cash?"Наличными курьеру":e.bankcard?"Банковской картой курьеру":"Не указан",console.log(e),r={cartId:this.cart.cartId,comment:"\n Тип оплаты:"+t+"\nКоментарий:"+i,address:{streetId:e.street.id,home:e.house,housing:e.housing,doorphone:e.doorphone,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:"+"+e.phone,mail:e.email,name:e.name},personsCount:e.personsCount},this.cartService.orderCart(r).subscribe())},r.prototype.checkStreet=function(e){var i;console.log(">>>>",e),this.checkForFields(this.orderCart._directives,this.requiredFields)&&(i={cartId:this.cart.cartId,comment:e.comment,address:{streetId:e.street.id,home:e.house,housing:e.housing,doorphone:e.doorphone,entrance:e.entrance,floor:e.floor,apartment:e.apartment},customer:{phone:"+"+e.phone,mail:e.email,name:e.name},personsCount:e.personsCount},this.cartService.checkStreet(i))},r.prototype.stringToNumber=function(e){return console.log(typeof e),"string"==typeof e?+e:"number"==typeof e?e:void console.error("Параметр home должен быть или string или number")},r.decorators=[{type:d.Directive,args:[{selector:"[orderCart]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={orderCart:[{type:d.Input}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){this.cartService=e,this.requiredFields=["name","phone","street","house"],this.checkerFields=new s.BehaviorSubject(undefined)}i.OrderCartUserDirective=t});e.unwrapExports(W);W.OrderCartUserDirective;var U=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){this.changeAmount(this.action)},r.prototype.changeAmount=function(e){switch(e){case"+":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount+1);break;case"-":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount-1);break;default:console.log("Директива SetDishAmount получила ложное значение action")}},r.decorators=[{type:d.Directive,args:[{selector:"[setDishAmount]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={action:[{type:d.Input}],dish:[{type:d.Input}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){var i=this;this.cartService=e,this.cartService.userCart().subscribe(function(e){return i.cart=e})}i.SetAmountDirective=t});e.unwrapExports(U);U.SetAmountDirective;var J=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.ngOnInit=function(){var e=this;this.renderer.addClass(this.el.nativeElement,"dish-calculator"),this.amountDish=this.amount,this.amountDishToAdd.emit(this.amountDish),this.price=this.renderer.createElement("div"),this.renderer.addClass(this.price,"dish-price"),setTimeout(function(){e.renderDish(e.dish),e.render(e.dish.modifiers)},100)},r.prototype.renderDish=function(e){var i=this,t=this.renderer.createElement("div");this.renderer.addClass(t,"dish-wraper"),this.renderer.appendChild(this.el.nativeElement,t);var r=this.renderer.createElement("div");this.renderer.addClass(r,"name"),this.renderer.appendChild(t,r);var n=this.renderer.createElement("div");this.renderer.addClass(n,"title"),this.renderer.setProperty(n,"innerHTML",this.dish.name),this.renderer.appendChild(r,n);var o=this.renderer.createElement("div");this.renderer.addClass(r,"weight"),this.renderer.addClass(r,"dish"),this.renderer.appendChild(t,o);var s=this.renderer.createElement("div");this.renderer.addClass(s,"value"),this.renderer.setProperty(s,"innerHTML",(1e3*this.dish.weight).toFixed(0)+" г."),0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(s,"zero"),this.renderer.appendChild(o,s),this.renderer.setProperty(this.price,"innerHTML",this.dish.price);var d=this.renderer.createElement("div");this.renderer.addClass(d,"price"),this.renderer.addClass(d,"total"),this.renderer.appendChild(d,this.price),this.renderer.appendChild(t,d);var a=this.renderer.createElement("div");this.renderer.addClass(a,"quantity"),this.renderer.appendChild(t,a);var c=this.renderer.createElement("a");this.renderer.addClass(c,"quantity__button"),this.renderer.addClass(c,"minus"),this.renderer.setProperty(c,"innerHTML","&#8722;"),this.renderer.listen(c,"click",function(e){i.changeAmountdish(-1),i.renderer.setProperty(l,"innerHTML",i.amountDish),i.renderer.setProperty(i.price,"innerHTML",i.generatePrice(i.dish.price)),i.innerTotalWeight(p)}),this.renderer.appendChild(a,c);var l=this.renderer.createElement("span");this.renderer.addClass(l,"quantity__counter"),this.renderer.setProperty(l,"innerHTML",this.amountDish),this.renderer.appendChild(a,l);var m=this.renderer.createElement("a");this.renderer.addClass(m,"quantity__button"),this.renderer.addClass(c,"plus"),this.renderer.setProperty(m,"innerHTML","&#x2b;"),this.renderer.listen(m,"click",function(e){i.changeAmountdish(1),i.renderer.setProperty(l,"innerHTML",i.amountDish),i.renderer.setProperty(i.price,"innerHTML",i.generatePrice(i.dish.price)),i.innerTotalWeight(p)}),this.renderer.appendChild(a,m);var h=this.renderer.createElement("div");this.renderer.addClass(r,"weight"),this.renderer.addClass(r,"total"),this.renderer.appendChild(t,h);var p=this.renderer.createElement("div");0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(p,"zero"),this.renderer.addClass(p,"value"),this.innerTotalWeight(p),this.renderer.appendChild(h,p),this.weightTotal=p,this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(e.price));var u=this.renderer.createElement("div");this.renderer.addClass(u,"price"),this.renderer.addClass(u,"total"),this.renderer.appendChild(u,this.price),this.renderer.appendChild(t,u)},r.prototype.generatePrice=function(e,i,t){var r=this,n=[];this.selectedModifiers&&this.selectedModifiers.forEach(function(t){r.dish.modifiers.forEach(function(e){var i=e.childModifiers.filter(function(e){return e.modifierId===t.id});0<i.length&&(i[0].groupId=e.group.id,n.push(i[0]))})});var o=0;return n.forEach(function(e){o+=e.dish.price*r.amountModifires[e.groupId][e.modifierId]}),o*=this.amountDish,e*this.amountDish+o+'<div class="currency">&nbsp;&#x20bd;</div>'},r.prototype.generateTotalWeight=function(){var i=this,r=[];this.selectedModifiers&&this.selectedModifiers.forEach(function(t){i.dish.modifiers.forEach(function(e){var i=e.childModifiers.filter(function(e){return e.modifierId===t.id});0<i.length&&(i[0].groupId=e.group.id,r.push(i[0]))})});var t=0;return r.forEach(function(e){t+=e.dish.weight*i.amountModifires[e.groupId][e.modifierId]*1e3}),t=parseFloat((t*this.amountDish).toFixed(2)),console.log(t,1e3*this.dish.weight*this.amountDish),console.log(this.dish.weight,this.amountDish),(1e3*this.dish.weight*this.amountDish+t).toFixed(0)+" г. <div class='separator'></div>"},r.prototype.innerTotalWeight=function(e){this.renderer.setProperty(e,"innerHTML",this.generateTotalWeight())},r.prototype.changeAmountdish=function(e){this.amountDish=this.amountDish+e,this.amountDish<=0&&(this.amountDish=1),199<=this.amountDish&&(this.amountDish=199),this.amountDishToAdd.emit(this.amountDish)},r.prototype.render=function(e){var i,n=this;this.setModifires(),0<e.length&&(i=this.renderer.createElement("h5"),this.renderer.setProperty(i,"innerHTML","К этому блюду можно добавить:")),e.forEach(function(t){var e,r;n.stateModifiers[t.modifierId]={},n.amountModifires[t.modifierId]={},t.dish?(e=n.groupDiv("Одночные модификаторы не поддерживаются"),n.renderer.appendChild(n.el.nativeElement,e),console.log("elementGroup",t)):t.childModifiers&&(r=n.groupDiv(t.group?t.group.name:"Ошибка"),n.renderer.appendChild(n.el.nativeElement,r),t.childModifiers.forEach(function(e){var i=n.modifireDiv(e,t.modifierId);n.renderer.appendChild(r,i),e.defaultAmount<1?n.stateModifiers[t.modifierId][e.modifierId]=!1:n.stateModifiers[t.modifierId][e.modifierId]=!0}))}),0<e.length&&(i=this.renderer.createElement("div"),this.renderer.setProperty(i,"innerHTML","<p>* — Количество добавленых опций блюда применяется для каждой порции</p>"),this.renderer.appendChild(this.el.nativeElement,i))},r.prototype.groupDiv=function(e){var i=this.renderer.createElement("div");return this.renderer.addClass(i,"group-modifires-wraper"),this.renderer.appendChild(i,this.renderer.createText(""+e)),i},r.prototype.modifireDiv=function(e,i){var t=this.renderer.createElement("div");return this.renderer.addClass(t,"additional-item"),this.renderOneModifire(e,t,i),t},r.prototype.renderOneModifire=function(e,i,t){console.info("renderOneModifire",e),console.info("renderOneModifire selectedModifiers",this.selectedModifiers);var r=this.renderer.createElement("div");this.renderer.addClass(r,"item-name");var n=this.renderer.createElement("label");this.renderer.setAttribute(n,"for",e.modifierId),this.renderer.appendChild(r,n),this.renderer.setProperty(n,"innerHTML",e.dish.name),this.renderer.appendChild(i,r);var o=this.renderer.createElement("div");this.renderer.addClass(o,"left-weight-modifire-wraper");var s=this.renderer.createElement("div");this.renderer.addClass(s,"weight"),(0===e.dish.weight||e.dish.weight<0)&&this.renderer.addClass(s,"zero"),this.renderer.setProperty(s,"innerHTML",(1e3*e.dish.weight).toFixed(0)+" г."),this.renderer.appendChild(o,s),this.renderer.appendChild(i,o);var d=this.renderer.createElement("div"),a=e.minAmount,c=e.maxAmount,l=e.defaultAmount;switch(console.info("min max def",a,c,l),!0){case 0===a&&0===c&&0===l:case 0===a&&1===c&&0===l:this.renderCheckbox(e,!1,d,i,t);break;case 0===a&&1===c&&1===l:this.renderCheckbox(e,!0,d,i,t);break;case 1===a&&1===c&&1===l:console.error(e.dish.name,"Значение не поддается настройке:",a,c,l);break;case a<=c&&a<=l&&l<=c&&1<c:this.renderInputButton(e,t,d,i);break;default:console.error(e.dish.name,"Ошибка рендера модификатора, для значений:",a,c,l)}0<e.maxAmount&&e.minAmount;var m=this.renderer.createElement("div");this.renderer.addClass(m,"right-weight-modifire-wraper");var h=this.renderer.createElement("div");this.renderer.addClass(h,"weight"),(0===e.dish.weight||e.dish.weight<0)&&this.renderer.addClass(h,"zero"),this.renderer.setProperty(h,"innerHTML",(1e3*e.dish.weight).toFixed(0)+' г.<div class="separator"></div>'),this.renderer.appendChild(m,h),this.renderer.appendChild(i,m);var p,u=this.renderer.createElement("div");this.renderer.addClass(u,"item-price"),0<e.dish.price?(p=e.dish.price+"<div class = 'currency'>&nbsp;&#x20bd;</div>",this.renderer.setProperty(u,"innerHTML",p),this.renderer.appendChild(i,u)):this.renderer.addClass(u,"zero-price"),this.setModifires(),this.innerTotalWeight(this.weightTotal),this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(this.dish.price))},r.prototype.renderCheckbox=function(e,i,t,r,n){var o=this,s=this.renderer.createElement("input");this.renderer.setAttribute(s,"type","checkbox"),this.renderer.setAttribute(s,"id",e.modifierId),i?(this.renderer.setProperty(s,"checked",!0),e.checked=!0,this.stateModifiers[n][e.modifierId]=!0,this.amountModifires[n][e.modifierId]=1):(e.checked=!1,this.stateModifiers[n][e.modifierId]=!1,this.amountModifires[n][e.modifierId]=0),this.renderer.addClass(s,"modal-checkbox"),this.renderer.appendChild(t,s),this.renderer.listen(s,"change",function(i){if(o.idRadioBox(n)){for(var e in o.stateModifiers[n])o.stateModifiers[n].hasOwnProperty(e)&&(o.stateModifiers[n][e]=!1);i.target.parentElement.parentElement.parentElement.querySelectorAll("input").forEach(function(e){e.id!=i.target.id&&(e.checked=!1)})}o.stateModifiers[n][i.target.id]=i.target.checked,i.target.checked&&(o.amountModifires[n][i.target.id]=1),o.setModifires(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))}),this.renderer.appendChild(r,t)},r.prototype.renderInputButton=function(t,r,e,i){var n=this,o=0<t.defaultAmount?t.defaultAmount:t.minAmount;0<o&&(this.stateModifiers[r][t.modifierId]=!0);var s=this.renderer.createElement("a");this.renderer.addClass(s,"quantity__button"),this.renderer.setProperty(s,"innerHTML","&#8722;"),this.renderer.appendChild(e,s),this.renderer.listen(s,"click",function(e){var i=+n.amountModifires[r][t.modifierId];n.amountModifires[r][t.modifierId]=i-1,n.amountModifires[r][t.modifierId]<t.minAmount&&(n.amountModifires[r][t.modifierId]=t.minAmount),n.renderer.setProperty(d,"innerHTML",n.amountModifires[r][t.modifierId]),0===n.amountModifires[r][t.modifierId]&&(n.stateModifiers[r][t.modifierId]=!1),n.setModifires(),n.innerTotalWeight(n.weightTotal),n.renderer.setProperty(n.price,"innerHTML",n.generatePrice(n.dish.price))});var d=this.renderer.createElement("span");this.renderer.addClass(d,"item-quantity__counter"),this.amountModifires[r][t.modifierId]=o,this.renderer.setProperty(d,"innerHTML",this.amountModifires[r][t.modifierId]),this.renderer.appendChild(e,d);var a=this.renderer.createElement("a");this.renderer.addClass(a,"quantity__button"),this.renderer.setProperty(a,"innerHTML","&#x2b;"),this.renderer.appendChild(e,a),this.renderer.appendChild(i,e),this.renderer.listen(a,"click",function(e){var i=+n.amountModifires[r][t.modifierId];n.amountModifires[r][t.modifierId]=1+i,n.amountModifires[r][t.modifierId]>t.maxAmount&&0!=t.maxAmount&&(n.amountModifires[r][t.modifierId]=t.maxAmount),n.renderer.setProperty(d,"innerHTML",n.amountModifires[r][t.modifierId]),0<n.amountModifires[r][t.modifierId]&&(n.stateModifiers[r][t.modifierId]=!0),n.setModifires(),n.innerTotalWeight(n.weightTotal),n.renderer.setProperty(n.price,"innerHTML",n.generatePrice(n.dish.price))})},r.prototype.setModifires=function(){var e,n,o=this,t=[],s=[];for(e in console.info("setModifires modifiersToSelect",t),console.info("setModifires stateModifiers before",this.stateModifiers),console.info("setModifires selectedModifiers before",this.selectedModifiers),this.stateModifiers){var i,r=this;for(i in this.stateModifiers[e])!function(i){(r.stateModifiers[e][i]||t.find(function(e){return e.modifierId==i}))&&s.push({id:i,amount:r.amountModifires[e][i],groupId:e})}(i)}this.selectedModifiers=s,0<this.dish.modifiers.length?(n=[],this.dish.modifiers.forEach(function(e){if(e.required)if(o.stateModifiers[e.modifierId]){var i,t=[],r=o.stateModifiers[e.modifierId];for(i in r)r.hasOwnProperty(i)&&r[i]&&t.push(r[i]);t.length<e.minAmount?(n.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+e.group.name}),o.validate.emit(!1),o.cartService.setModifires(s,n)):(o.validate.emit(!0),o.cartService.setModifires(s,[]))}else n.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+e.group.name}),o.validate.emit(!1),o.cartService.setModifires(s,n);else o.validate.emit(!0),o.cartService.setModifires(s)})):(this.validate.emit(!0),this.cartService.setModifires(s,[])),console.info("setModifires stateModifiers after",this.stateModifiers),console.info("setModifires selectedModifiers after",this.selectedModifiers)},r.prototype.idRadioBox=function(i){var e=this.dish.modifiers.find(function(e){return e.modifierId===i});return 1===e.minAmount&&1===e.maxAmount},r.prototype.checkMinAmountModifires=function(e,i){},r.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifires([],[])},r.decorators=[{type:d.Directive,args:[{selector:"[dishCalc]"}]}],r.ctorParameters=function(){return[{type:d.Renderer2},{type:d.ElementRef},{type:o.NgRestoCartService}]},r.propDecorators={dish:[{type:d.Input}],amount:[{type:d.Input}],selectedModifiers:[{type:d.Input}],validate:[{type:d.Output}],amountDishToAdd:[{type:d.Output}]},r);function r(e,i,t){this.renderer=e,this.el=i,this.cartService=t,this.validate=new d.EventEmitter,this.amountDishToAdd=new d.EventEmitter,this.amountModifires={},this.stateModifiers={}}i.DishCalcDirective=t});e.unwrapExports(J);J.DishCalcDirective;var K=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){var e,i,t,r=this;this.locationId||(this.streetId||this.street)&&this.home||this.selfService?(e=this.comment||"Не указан",this.paymentMethod,i={cartId:this.cart.cartId,comment:e,customer:{phone:this.preparePhone(this.phone),mail:this.email,name:this.name},personsCount:+this.personsCount},this.paymentMethodId&&(i.paymentMethodId=this.paymentMethodId),this.date&&(i.date=this.date),this.notifyMethodId&&(i.notifyMethodId=this.notifyMethodId),i.selfService=this.selfService,this.bonuses&&(i.bonuses=this.bonuses.map(function(e){return{name:e.name,amount:e.amount}})),this.locationId?i.locationId=this.locationId:i.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""},t=this.cart.id,this.cartService.orderCart(i).subscribe(function(e){e.action&&e.action.paymentRedirect?window.location.href=e.action.paymentRedirect:r.success.emit(t)},function(e){return r.error.emit(e)})):this.error.emit("Нужно указать адрес")},r.prototype.ngOnChanges=function(e){this.cartService.OrderFormChange.next(e)},r.prototype.checkStreet=function(){var i=this,e=this.comment||"Не указан",t=(this.paymentMethod,{cartId:this.cart.cartId,comment:e,customer:{phone:this.phone?this.preparePhone(this.phone):null,mail:this.email,name:this.name||null},personsCount:+this.personsCount});t.selfService=this.selfService,this.paymentMethodId&&(t.paymentMethodId=this.paymentMethodId),this.date&&(t.date=this.date),this.notifyMethodId&&(t.notifyMethodId=this.notifyMethodId),this.locationId?t.locationId=this.locationId:t.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""},this.isChecking.emit(!0),this.cartService.checkStreetV2(t).subscribe(function(e){return i.isChecking.emit(!1)},function(e){return i.isChecking.emit(!1)})},r.prototype.preparePhone=function(e){return e?(e="+"+e.replace(/[^0-9]/gim,"")).replace("+8","+7"):""},r.decorators=[{type:d.Directive,args:[{selector:"[checkout]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={cartTotal:[{type:d.Input}],bonuses:[{type:d.Input}],name:[{type:d.Input}],email:[{type:d.Input}],phone:[{type:d.Input}],delivery:[{type:d.Input}],selfService:[{type:d.Input}],locationId:[{type:d.Input}],street:[{type:d.Input}],streetId:[{type:d.Input}],home:[{type:d.Input}],housing:[{type:d.Input}],apartment:[{type:d.Input}],entrance:[{type:d.Input}],doorphone:[{type:d.Input}],floor:[{type:d.Input}],paymentMethod:[{type:d.Input}],paymentMethodId:[{type:d.Input}],personsCount:[{type:d.Input}],comment:[{type:d.Input}],date:[{type:d.Input}],notifyMethodId:[{type:d.Input}],success:[{type:d.Output}],error:[{type:d.Output}],isChecking:[{type:d.Output}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){var i=this;this.cartService=e,this.success=new d.EventEmitter,this.error=new d.EventEmitter,this.isChecking=new d.EventEmitter,this.cartService.userCart().subscribe(function(e){return i.cart=e}),this.cartService.OrderFormChange.pipe(a.filter(function(){if(i.locationId||(i.streetId||i.street)&&i.home||i.selfService)return!0}),a.debounceTime(1e3)).subscribe(function(){return i.checkStreet()})}i.CheckoutDirective=t});e.unwrapExports(K);K.CheckoutDirective;var Q=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.onClick=function(){this.setComment()},r.prototype.setComment=function(){var i=this;this.cartService.setDishComment(this.dish.id,this.comment).subscribe(function(e){return i.success.emit(!0)},function(e){return i.error.emit(e)})},r.decorators=[{type:d.Directive,args:[{selector:"[setDishComment]"}]}],r.ctorParameters=function(){return[{type:o.NgRestoCartService}]},r.propDecorators={comment:[{type:d.Input}],dish:[{type:d.Input}],success:[{type:d.Output}],error:[{type:d.Output}],onClick:[{type:d.HostListener,args:["click"]}]},r);function r(e){this.cartService=e,this.success=new d.EventEmitter,this.error=new d.EventEmitter}i.SetDishCommentDirective=t});e.unwrapExports(Q);Q.SetDishCommentDirective;var Y=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.ngOnInit=function(){this.checkValid()},r.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifires([],[])},r.prototype.ngOnChanges=function(){var e,i,t,r,n,o;if(this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.dish&&this.dish.modifiers){try{for(var s=F.__values(this.dish.modifiers),d=s.next();!d.done;d=s.next()){var a=d.value,c=null;switch(this.modifiers.indexById[a.modifierId]=a,this.modifiers.custom.fixed||this.modifiers.baseList.length||!a.childModifiers||2!=a.childModifiers.length||a.maxAmount!=a.maxAmount||1!=a.maxAmount?a.group&&a.childModifiers&&a.childModifiers.length&&a.childModifiers.find(function(e){return e.dish})?(c="group",this.modifiers.baseList.push(a),2==a.minAmount&&2==a.maxAmount&&(this.isTwoPartsAssembledTemplate=!0),console.info("Group modifier:",a)):a.dish?(c="single",this.modifiers.baseList.push(a),console.info("Single modifier:",a)):(c="broken",console.warn("Broken modifier:",a)):(c="custom",this.modifiers.custom.fixed=a,console.info("Custom Fixed modifier:",a)),c){case"group":case"custom":this.modifiersValueTree[a.modifierId]={};try{for(var l=F.__values(a.childModifiers),m=l.next();!m.done;m=l.next()){var h=m.value;this.modifiers.indexById[h.modifierId]=h,this.modifiersValueTree[a.modifierId][h.modifierId]=h.defaultAmount}}catch(x){t={error:x}}finally{try{m&&!m.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}this.calculateTotalAmountInGroup(a.modifierId);break;case"single":this.modifiersValueTree.single||(this.modifiersValueTree.single={}),this.modifiers.indexById[a.modifierId]=a,this.modifiersValueTree.single[a.modifierId]=a.defaultAmount}this.checkImagesInModifier(a.modifierId)}}catch(b){e={error:b}}finally{try{d&&!d.done&&(i=s["return"])&&i.call(s)}finally{if(e)throw e.error}}this.calculateTotalPrice()}if(this.selectedModifiers&&this.selectedModifiers.length)try{for(var p=F.__values(this.selectedModifiers),u=p.next();!u.done;u=p.next()){var f=u.value;if(f.amount)try{var g=f.groupId||"single",v=this.modifiers.indexById[g],a=this.modifiers.indexById[f.id];v&&2==v.minAmount&&2==v.maxAmount?this.selectTwoPartsAssembledModifier(a):(this.modifiersValueTree[g][f.id]=f.amount,this.calculateTotalAmountInGroup(g))}catch(y){console.error("Invalid modifiers amounts",y)}}}catch(I){n={error:I}}finally{try{u&&!u.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}this.calculateTotalPrice(),this.checkValid()},r.prototype.calculateTotalAmountInGroup=function(e){if("single"!=e)return this.modifiers.indexById[e].totalAmount=Object.values(this.modifiersValueTree[e]).reduce(function(e,i){return e+i}),this.modifiers.indexById[e].totalAmount},r.prototype.checkImagesInModifier=function(e){var i=this.modifiers.indexById[e];this.modifiers.indexById[e].imagesIsset=!!(i.dish&&i.dish.images&&i.dish.images.length),this.modifiers.indexById[e].childImagesIsset=!!this.modifiers.indexById[e].childModifiers.find(function(e){return!!(e&&e.dish&&e.dish.images&&e.dish.images.length)})},r.prototype.calculateTotalPrice=function(){var e,i=this.dish.price||0;for(e in this.modifiersValueTree)for(var t in this.modifiersValueTree[e]){var r,n=this.modifiersValueTree[e][t];!n||(r=this.modifiers.indexById[t])&&r.dish&&r.dish.price&&(i+=r.dish.price*n)}this.totalPrice=i,this.setModifiers()},r.prototype.getModifiersIds=function(e){return{groupId:e.dish&&e.dish.groupId?e.dish.groupId:undefined,modifierId:e.modifierId}},r.prototype.selectTwoPartsAssembledModifier=function(e){var i=this.getModifiersIds(e),t=i.groupId,r=void 0===t?"single":t,n=i.modifierId,o=(e.minAmount,e.maxAmount,this.modifiers.indexById[r]||{}),s=o.maxAmount,d=void 0===s?0:s,a=this.modifiersValueTree[r][n],c=a?0:1;this.twoPartsAssembledModifiersIdsByGroupId[r]||(this.twoPartsAssembledModifiersIdsByGroupId[r]=[]);var l=this.modifiers.indexById[r].totalAmount-a+c;if(d<l){if(!this.twoPartsAssembledModifiersIdsByGroupId[r].length)return console.warn("Limit: max "+d+". Current "+l),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[r].group.name+'" - не более '+d));for(var m in this.modifiersValueTree[r])this.modifiersValueTree[r][m]=0;this.twoPartsAssembledModifiersIdsByGroupId[r]=this.twoPartsAssembledModifiersIdsByGroupId[r].slice(1,2),this.modifiersValueTree[r][this.twoPartsAssembledModifiersIdsByGroupId[r][0]]=1}else 0==l&&(this.twoPartsAssembledModifiersIdsByGroupId[r]=[]);c&&!this.twoPartsAssembledModifiersIdsByGroupId[r].find(function(e){return e==n})&&this.twoPartsAssembledModifiersIdsByGroupId[r].push(n),this.modifiersValueTree[r][n]=c,this.calculateTotalAmountInGroup(r),this.calculateTotalPrice()},r.prototype.changeModifierAmount=function(e,i,t){if(!(i<0)){var r=this.getModifiersIds(e),n=r.groupId,o=void 0===n?"single":n,s=r.modifierId,d=e.minAmount,a=e.maxAmount,c=this.modifiers.indexById[o]||{},l=c.minAmount,m=void 0===l?0:l,h=c.maxAmount,p=void 0===h?0:h,u=this.modifiersValueTree[o][s];if("checkbox"==t&&"single"!==o){if(m<=1&&1==p){if(i<m)return;for(var f in this.modifiersValueTree[o])this.modifiersValueTree[o][f]=0;this.calculateTotalAmountInGroup(o)}if(0==i)return void this.calculateTotalPrice()}if(m||p){var g=this.modifiers.indexById[o].totalAmount-u+i;if(g<m)return console.warn("Limit: min "+m+". Current "+g),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[o].group.name+'" - не менее '+m));if(p<g)return console.warn("Limit: max "+p+". Current "+g),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[o].group.name+'" - не более '+p))}if(d||a){if(i<d)switch(t){case"plus":i=d;break;case"minus":i=0}a<i&&(i=a)}this.modifiersValueTree[o][s]=i,this.calculateTotalAmountInGroup(o),this.calculateTotalPrice()}},r.prototype.setModifiers=function(){var e,i=[];for(e in this.modifiersValueTree)for(var t in this.modifiersValueTree[e]){var r=this.modifiersValueTree[e][t];r&&i.push({id:t,amount:r,groupId:"single"!==e?e:undefined})}i.length&&(this.checkValid(),this.cartService.setModifires(i,[]))},r.prototype.checkValid=function(){var e,i=!0;for(e in this.modifiersValueTree){var t,r=this.modifiers.indexById[e];r.required&&((t=this.calculateTotalAmountInGroup(e))<r.minAmount&&(i=!1,console.warn("Modifier "+e+" min amount: "+r.minAmount)),t>r.maxAmount&&(i=!1,console.warn("Modifier "+e+" max amount: "+r.maxAmount)))}this.validate.emit(i)},r.decorators=[{type:d.Component,args:[{selector:"dish-calc",template:'<div *ngIf="dish" class="ng-cart-dish-calc" [ngClass]="{\'ng-cart-dish-calc-two-parts-assembled\': isTwoPartsAssembledTemplate}">\n    <div class="dish">\n        <div class="dish-image-box">\n            <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n        </div>\n        <div class="dish-description-box">\n            <div class="dish-name">{{ dish.name }}</div>\n            <div class="dish-ingredients">{{ dish.description }}</div>\n            <div class="dish-price-box">\n                <ng-container *ngIf="!modifiers.custom.fixed; else modifierFixedTemplate">\n                    <div class="price" [ngClass]="{\'zero-price\': !dish.price}">\n                        <span>{{ dish.price }}</span> ₽\n                    </div>\n                </ng-container>\n                <ng-template #modifierFixedTemplate>\n                    <ng-container *ngIf="modifiers.custom.fixed as modifier">\n                        <div class="modifier-fixed">\n                            <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                <div class="item"\n                                     [ngClass]="{selected: !!modifiersValueTree[modifier.modifierId][childModifier.modifierId]}"\n                                     (click)="changeModifierAmount(childModifier, 1, \'checkbox\')">\n                                    {{ childModifier.dish?.name }}\n                                </div>\n                            </ng-container>\n                        </div>\n                        <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                            <ng-container *ngIf="!!modifiersValueTree[modifier.modifierId][childModifier.modifierId]">\n                                <div class="price" [ngClass]="{\'zero-price\': !childModifier.dish?.price}">\n                                    <span>{{ childModifier.dish?.price }}</span> ₽\n                                </div>\n                            </ng-container>\n                        </ng-container>\n                    </ng-container>\n                </ng-template>\n\n            </div>\n        </div>\n    </div>\n    <div class="modifiers" *ngIf="modifiers.baseList?.length">\n        <ng-container *ngFor="let modifier of modifiers.baseList">\n            <div class="modifier-group">\n                <ng-container *ngIf="modifier.dish">\n                    <div class="modifier-header" *ngIf="modifier.group as group">\n                        <div class="modifier-name" *ngIf="group.name">{{ group.name }}</div>\n                        <div class="modifier-description" *ngIf="group.description">{{ group.description }}</div>\n                    </div>\n\n                    <div class="modifier-box" [ngClass]="{\'without-images\': !modifier.childImagesIsset}">\n                        \x3c!-- Single modifier --\x3e\n                        <ng-container *ngTemplateOutlet="modifierTemplate; context: {\n                            modifier: modifier,\n                            groupId: \'single\',\n                            amount: modifiersValueTree[\'single\'][modifier.modifierId],\n                            groupAmount: modifiersValueTree[\'single\'][modifier.modifierId],\n                            groupMinAmount: modifier.minAmount || 0,\n                            groupMaxAmount: modifier.maxAmount || 100\n                        }"></ng-container>\n                    </div>\n                </ng-container>\n\n                <ng-container *ngIf="modifier.childModifiers?.length">\n                    <ng-container *ngIf="modifier.minAmount == 2 && modifier.maxAmount == 2; then twoPartsAssembledTemplate else groupTemplate">\n                    </ng-container>\n\n                    \x3c!-- Base group modifier view --\x3e\n                    <ng-template #groupTemplate>\n                        <div class="modifier-header" *ngIf="modifier.group as group">\n                            <div class="modifier-name" *ngIf="group.name">{{ group.name }}</div>\n                            <div class="modifier-description" *ngIf="group.description">{{ group.description }}</div>\n                        </div>\n                        <div class="modifier-children" [ngClass]="{\'without-images\': !modifier.imagesIsset}">\n                            <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                \x3c!-- Group modifier --\x3e\n                                <ng-container *ngTemplateOutlet="modifierTemplate; context: {\n                            modifier: childModifier,\n                            groupId: modifier.modifierId,\n                            amount: modifiersValueTree[modifier.modifierId][childModifier.modifierId],\n                            groupAmount: modifiers.indexById[modifier.modifierId].totalAmount,\n                            groupMinAmount: modifier.minAmount || 0,\n                            groupMaxAmount: modifier.maxAmount || 100\n                        }"></ng-container>\n\n                            </ng-container>\n                        </div>\n                    </ng-template>\n\n                    \x3c!-- Two parts assembled group modifier view (like pizza from two halves) --\x3e\n                    <ng-template #twoPartsAssembledTemplate>\n                        <div class="two-parts-assembled">\n                            <div class="two-parts-assembled-header" [ngClass]="{empty: !twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId]?.length}">\n                                <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                    <ng-container *ngIf="modifiersValueTree[modifier.modifierId][childModifier.modifierId]">\n                                        <ng-container *ngIf="childModifier.dish as dish">\n                                            <div class="selected-dish">\n                                                <div class="title">{{ dish.name }}</div>\n                                                <div class="image-box">\n                                                    <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n                                                </div>\n                                            </div>\n                                        </ng-container>\n                                        <ng-container *ngIf="modifiers.indexById[modifier.modifierId].totalAmount == 1">\n                                            <div class="selected-dish">\n                                                <div class="title">Выберите половину</div>\n                                                <div class="image-box">\n                                                    <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: {} }"></ng-container>\n                                                </div>\n                                            </div>\n                                        </ng-container>\n                                    </ng-container>\n                                </ng-container>\n                            </div>\n\n                            <div class="two-parts-assembled-body">\n                                <div class="two-parts-assembled-body-name">Выберите любые две половинки</div>\n                                <div class="two-parts-assembled-body-list">\n                                    <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                        <div class="two-parts-assembled-body-list-dish"\n                                             (click)="selectTwoPartsAssembledModifier(childModifier)"\n                                             [ngClass]="{selected: modifiersValueTree[modifier.modifierId][childModifier.modifierId]}"\n                                             *ngIf="childModifier.dish as dish">\n                                            <div class="image-box">\n                                                <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n                                            </div>\n                                            <div class="dish-name">\n                                                {{ dish.name }}\n                                            </div>\n                                            <div class="dish-price">\n                                                <div [ngClass]="{\'zero-price\': !dish.price}">\n                                                    <span>{{ dish.price }}</span> ₽\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </ng-container>\n                                </div>\n                            </div>\n                        </div>\n                    </ng-template>\n\n\n                </ng-container>\n\n            </div>\n        </ng-container>\n    </div>\n    <div class="result">\n        <span class="text">ИТОГО:</span>\n        <span class="price">\n            <span>{{ totalPrice}}</span> ₽\n        </span>\n    </div>\n    <div class="comment" *ngIf="isTwoPartsAssembledTemplate">\n        <div class="title">Комментарий</div>\n        <div class="input-box">\n            <input #commentInput type="text" placeholder="" (keyup)="comment.emit(commentInput.value)">\n        </div>\n    </div>\n</div>\n\n\n\n\x3c!-- Template block #dishImageTemplate --\x3e\n\n<ng-template #dishImageTemplate let-dish="dish">\n    <ng-container *ngIf="dish?.images && dish.images[0]?.images?.small; else imgPlaceholder">\n        <div class="dish-image" [style.backgroundImage]="\'url(\' + imageUrl + dish.images[0].images.small + \')\'"></div>\n    </ng-container>\n    <ng-template #imgPlaceholder>\n        <div class="dish-image-placeholder"></div>\n    </ng-template>\n</ng-template>\n\n\x3c!-- Template block #modifierTemplate --\x3e\n\n<ng-template #modifierTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount"\n             let-groupAmount="groupAmount"\n             let-groupMinAmount="groupMinAmount"\n             let-groupMaxAmount="groupMaxAmount">\n    <ng-container *ngIf="modifier.dish as dish">\n        <div class="modifier-dish">\n            <div class="modifier-dish-image-box">\n                <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n            </div>\n            <div class="modifier-dish-description-box">\n                <div class="modifier-dish-name">{{ dish.name }}</div>\n                <div class="modifier-dish-weight" *ngIf="dish.weight">{{ dish.weight * 1000 }} гр</div>\n            </div>\n            <div class="modifier-dish-price-box">\n                <div [ngClass]="{\'zero-price\': !dish.price}">\n                    <span>{{ dish.price }}</span> ₽\n                </div>\n            </div>\n            <div class="modifier-dish-action-box">\n                <ng-container *ngIf="groupMinAmount <= 1 && groupMaxAmount == 1; else counterTemplate">\n                    <ng-container *ngTemplateOutlet="modifierCheckboxTemplate; context: {\n                        modifier: modifier,\n                        groupId: groupId,\n                        amount: amount\n                    }"></ng-container>\n                </ng-container>\n\n                <ng-template #counterTemplate>\n                    <ng-container *ngTemplateOutlet="modifierCounterTemplate; context: {\n                        modifier: modifier,\n                        groupId: groupId,\n                        amount: amount,\n                        groupAmount: groupAmount,\n                        groupMinAmount: groupMinAmount,\n                        groupMaxAmount: groupMaxAmount\n                    }"></ng-container>\n                </ng-template>\n\n            </div>\n        </div>\n    </ng-container>\n</ng-template>\n\n\x3c!-- Template block #modifierCounterTemplate --\x3e\n\n<ng-template #modifierCounterTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount"\n             let-groupAmount="groupAmount"\n             let-groupMinAmount="groupMinAmount"\n             let-groupMaxAmount="groupMaxAmount">\n    <ng-container>\n        <div class="modifier-counter" [ngClass]="{disabled: !amount && groupAmount >= groupMaxAmount}">\n            <div\n                    class="minus"\n                    [ngClass]="{disabled: !amount || groupAmount <= groupMinAmount}"\n                    (click)="changeModifierAmount(modifier, amount - 1, \'minus\')"\n                    onselectstart="return false;">-</div>\n            <input [value]="amount" readonly #input>\n            <div\n                    class="plus"\n                    [ngClass]="{disabled: groupAmount >= groupMaxAmount}"\n                    (click)="changeModifierAmount(modifier, amount + 1, \'plus\')"\n                    onselectstart="return false;">+</div>\n        </div>\n    </ng-container>\n</ng-template>\n\n\x3c!-- Template block #modifierCheckboxTemplate --\x3e\n\n<ng-template #modifierCheckboxTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount">\n    <ng-container>\n        <div\n                class="modifier-checkbox"\n                [ngClass]="{selected: amount}"\n                (click)="changeModifierAmount(modifier, amount ? 0 : 1, \'checkbox\')"></div>\n    </ng-container>\n</ng-template>\n',styles:['.dish{display:flex;align-items:flex-start;padding-bottom:34px;border-bottom:2px solid #969696}.dish .dish-image-box{position:relative;width:250px;height:170px;box-sizing:border-box;text-align:center;background-color:#eee;background-size:50%}.dish .dish-description-box{margin-left:34px;height:170px;display:flex;flex-direction:column;align-items:stretch;padding:5px 0 0;box-sizing:border-box}.dish .dish-description-box .dish-name{font-weight:700;font-size:28px;line-height:32px;letter-spacing:2.4px;color:#0a0909}.dish .dish-description-box .dish-ingredients{font-size:15px;line-height:17px;color:#000;margin-top:15px;overflow:hidden;flex-grow:1}.dish .dish-description-box .dish-price-box{font-weight:700;font-size:20px;line-height:23px;display:flex;align-items:center;justify-content:space-between;height:45px;margin-right:49px}.ng-cart-dish-calc-two-parts-assembled .dish{border:none;margin-left:0;padding-bottom:0}.ng-cart-dish-calc-two-parts-assembled .dish .dish-image-box{display:none}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box{width:100%;height:auto}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-name{text-align:center;font-weight:700;font-size:28px;line-height:32px;letter-spacing:2.4px;color:#0a0909;text-transform:uppercase}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-ingredients,.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-price-box{display:none}.dish-image{width:250px;height:100%;border-radius:0;background-size:cover;background-position:top;background-repeat:no-repeat}.result{margin-top:49px;font-weight:700;font-size:24px;line-height:28px;color:#0a0909;text-align:right}.result .price{margin-left:76px}.comment{padding-bottom:15px}.comment .title{font-weight:500;font-size:20px;line-height:23px;color:#0a0909;margin:30px 0 20px}.comment .input-box{margin-top:10px}.comment .input-box input{border:2px solid #969696;box-sizing:border-box;border-radius:15px;height:45px;line-height:45px;font-style:italic;font-weight:400;font-size:20px;color:#969696;padding:0 20px}.modifiers .modifier-group{margin-top:25px;padding-bottom:25px;border-bottom:2px solid #969696}.modifiers .modifier-header{margin-bottom:25px}.modifiers .modifier-header .modifier-name{font-weight:500;font-size:20px;line-height:23px;color:#0a0909}.modifiers .modifier-header .modifier-description{font-size:15px;line-height:17px;color:#0a0909}.modifiers .modifier-dish{display:flex;justify-content:center;align-items:center;margin-bottom:2px;height:100px;box-sizing:border-box}.modifiers .modifier-dish .modifier-dish-image-box{position:relative;width:100px;height:100px;box-sizing:border-box;text-align:center;background-color:#fff;background-size:50%;margin-right:28px}.modifiers .modifier-dish .modifier-dish-image-box .dish-image{width:100%;height:100%;background-size:contain;background-position:center}.modifiers .modifier-dish .modifier-dish-description-box{flex-grow:1;display:flex;flex-direction:column;justify-content:center}.modifiers .modifier-dish .modifier-dish-description-box .modifier-dish-name{font-weight:500;font-size:20px;line-height:23px;color:#0a0909}.modifiers .modifier-dish .modifier-dish-description-box .modifier-dish-weight{font-size:20px;line-height:23px;color:#0a0909;margin-top:10px}.modifiers .modifier-dish .modifier-dish-price-box{font-weight:700;font-size:20px;line-height:23px;color:#0a0909;margin-right:105px}.modifiers .modifier-dish .modifier-dish-price-box .zero-price{display:none}.modifiers .modifier-dish .modifier-dish-action-box{width:151px;display:flex;justify-content:center}.two-parts-assembled .two-parts-assembled-header{display:flex;align-items:center;justify-content:center;padding-bottom:28px;opacity:1;border-bottom:2px solid #969696;height:230px;overflow:hidden;transition:.5s}.two-parts-assembled .two-parts-assembled-header.empty{border-bottom:none;height:0;opacity:0}.two-parts-assembled .two-parts-assembled-header .selected-dish{display:flex;align-items:center;justify-content:flex-end;width:50%}.two-parts-assembled .two-parts-assembled-header .selected-dish .title{font-size:21px;line-height:25px;color:#0a0909;margin-right:24px}.two-parts-assembled .two-parts-assembled-header .selected-dish .image-box{width:100px;height:200px;overflow:hidden}.two-parts-assembled .two-parts-assembled-header .selected-dish .image-box .dish-image{width:200%;height:100%}.two-parts-assembled .two-parts-assembled-header .selected-dish:nth-child(2){flex-direction:row-reverse}.two-parts-assembled .two-parts-assembled-header .selected-dish:nth-child(2) .title{margin-left:24px}.two-parts-assembled .two-parts-assembled-header .selected-dish:nth-child(2) .image-box{direction:rtl}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-name{font-weight:500;font-size:20px;line-height:23px;color:#0a0909;padding:20px 0}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list{display:grid;grid-template-columns:1fr 1fr 1fr;margin-top:30px;grid-column-gap:30px;grid-row-gap:24px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish{display:flex;flex-direction:column;align-items:center;box-sizing:border-box;cursor:pointer;color:#0a0909;border:1.5px solid rgba(255,255,255,0)}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish.selected{border:1.5px solid #0a0909;border-radius:15px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .dish-name{font-weight:500;font-size:17px;line-height:20px;letter-spacing:2.4px;text-transform:uppercase;text-align:center;padding:0 5px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .dish-price{font-weight:700;font-size:20px;line-height:23px;padding:5px 0 10px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .image-box{width:228px;height:228px;border-radius:15px 15px 0 0}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .image-box .dish-image{width:100%;height:100%;border-radius:15px 15px 0 0}.modifier-fixed{border:2px solid #767676;box-sizing:border-box;border-radius:15px;display:flex;align-items:stretch;height:45px}.modifier-fixed .item{font-weight:500;font-size:20px;line-height:23px;width:142px;height:45px;color:#767676;display:flex;align-items:center;justify-content:center;margin-top:-2px}.modifier-fixed .item:first-child{margin-left:-2px}.modifier-fixed .item:last-child{margin-right:-2px}.modifier-fixed .item.selected{background:#0a0909;border-radius:15px;color:#fff}.modifier-fixed .item:not(.selected){cursor:pointer}.modifier-checkbox{width:50px;height:50px;background:#e0e0e0;border-radius:15px;cursor:pointer;display:flex;justify-content:center;align-items:center}.modifier-checkbox.selected:after{content:url("data:image/svg+xml; base64, PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgMTMuNUwxMS4zMjMxIDI2TDI2IDIiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMy41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==")}.modifier-counter{display:flex;align-items:center;position:relative;border:none;width:151px;height:50px;border-radius:15px;background:#e0e0e0}.modifier-counter.disabled{opacity:.3}.modifier-counter:not(.disabled) .minus.disabled,.modifier-counter:not(.disabled) .plus.disabled{opacity:.15;cursor:default}.modifier-counter input{border:none;background:0 0;width:100%;padding:0;height:50px;line-height:50px;text-align:center;font-weight:500;font-size:18px;color:#0a0909}.modifier-counter .minus,.modifier-counter .plus{display:block;position:absolute;top:0;height:50px;line-height:50px;text-align:center;font-style:normal;font-weight:700;font-size:18px;color:#0a0909;padding:0 30px;cursor:pointer}.modifier-counter .minus:hover,.modifier-counter .plus:hover{color:#000}.modifier-counter .minus:active,.modifier-counter .plus:active{color:#cc0009}.modifier-counter .minus.loading,.modifier-counter .plus.loading{opacity:.2}.modifier-counter .minus{left:0}.modifier-counter .plus{right:0}.without-images .modifier-dish-image-box{height:70px!important}.without-images .modifier-dish{height:70px}']}]}],r.ctorParameters=function(){return[{type:c.NgRestoCartService},{type:v.EventerService},{type:String,decorators:[{type:d.Inject,args:["ImageUrl"]}]}]},r.propDecorators={dish:[{type:d.Input}],amount:[{type:d.Input}],selectedModifiers:[{type:d.Input}],validate:[{type:d.Output}],amountDishToAdd:[{type:d.Output}],comment:[{type:d.Output}]},r);function r(e,i,t){this.cartService=e,this.eventer=i,this.validate=new d.EventEmitter,this.amountDishToAdd=new d.EventEmitter,this.comment=new d.EventEmitter,this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.twoPartsAssembledModifiersIdsByGroupId={},this.imageUrl=t}i.DishCalcComponent=t});e.unwrapExports(Y);Y.DishCalcComponent;var $=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=(r.prototype.ngOnInit=function(){this.checkValid()},r.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifires([],[])},r.prototype.ngOnChanges=function(){var e,i,t,r,n,o;if(this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.dish&&this.dish.modifiers){try{for(var s=F.__values(this.dish.modifiers),d=s.next();!d.done;d=s.next()){var a=d.value,c=null;switch(this.modifiers.indexById[a.modifierId]=a,this.modifiers.custom.fixed||this.modifiers.baseList.length||!a.childModifiers||2!=a.childModifiers.length||a.maxAmount!=a.maxAmount||1!=a.maxAmount?a.group&&a.childModifiers&&a.childModifiers.length&&a.childModifiers.find(function(e){return e.dish})?(c="group",this.modifiers.baseList.push(a),2==a.minAmount&&2==a.maxAmount&&(this.isTwoPartsAssembledTemplate=!0),console.info("Group modifier:",a)):a.dish?(c="single",this.modifiers.baseList.push(a),console.info("Single modifier:",a)):(c="broken",console.warn("Broken modifier:",a)):(c="custom",this.modifiers.custom.fixed=a,console.info("Custom Fixed modifier:",a)),c){case"group":case"custom":this.modifiersValueTree[a.modifierId]={};try{for(var l=F.__values(a.childModifiers),m=l.next();!m.done;m=l.next()){var h=m.value;this.modifiers.indexById[h.modifierId]=h,this.modifiersValueTree[a.modifierId][h.modifierId]=h.defaultAmount}}catch(x){t={error:x}}finally{try{m&&!m.done&&(r=l["return"])&&r.call(l)}finally{if(t)throw t.error}}this.calculateTotalAmountInGroup(a.modifierId);break;case"single":this.modifiersValueTree.single||(this.modifiersValueTree.single={}),this.modifiers.indexById[a.modifierId]=a,this.modifiersValueTree.single[a.modifierId]=a.defaultAmount}this.checkImagesInModifier(a.modifierId)}}catch(b){e={error:b}}finally{try{d&&!d.done&&(i=s["return"])&&i.call(s)}finally{if(e)throw e.error}}this.calculateTotalPrice()}if(this.selectedModifiers&&this.selectedModifiers.length)try{for(var p=F.__values(this.selectedModifiers),u=p.next();!u.done;u=p.next()){var f=u.value;if(f.amount)try{var g=f.groupId||"single",v=this.modifiers.indexById[g],a=this.modifiers.indexById[f.id];v&&2==v.minAmount&&2==v.maxAmount?this.selectTwoPartsAssembledModifier(a):(this.modifiersValueTree[g][f.id]=f.amount,this.calculateTotalAmountInGroup(g))}catch(y){console.error("Invalid modifiers amounts",y)}}}catch(I){n={error:I}}finally{try{u&&!u.done&&(o=p["return"])&&o.call(p)}finally{if(n)throw n.error}}this.calculateTotalPrice(),this.checkValid()},r.prototype.calculateTotalAmountInGroup=function(e){if("single"!=e)return this.modifiers.indexById[e].totalAmount=Object.values(this.modifiersValueTree[e]).reduce(function(e,i){return e+i}),this.modifiers.indexById[e].totalAmount},r.prototype.checkImagesInModifier=function(e){var i=this.modifiers.indexById[e];this.modifiers.indexById[e].imagesIsset=!!(i.dish&&i.dish.images&&i.dish.images.length),this.modifiers.indexById[e].childImagesIsset=!!this.modifiers.indexById[e].childModifiers.find(function(e){return!!(e&&e.dish&&e.dish.images&&e.dish.images.length)})},r.prototype.calculateTotalPrice=function(){var e,i=this.dish.price||0;for(e in this.modifiersValueTree)for(var t in this.modifiersValueTree[e]){var r,n=this.modifiersValueTree[e][t];!n||(r=this.modifiers.indexById[t])&&r.dish&&r.dish.price&&(i+=r.dish.price*n)}this.totalPrice=i,this.setModifiers()},r.prototype.getModifiersIds=function(e){return{groupId:e.dish&&e.dish.groupId?e.dish.groupId:undefined,modifierId:e.modifierId}},r.prototype.selectTwoPartsAssembledModifier=function(e){var i=this.getModifiersIds(e),t=i.groupId,r=void 0===t?"single":t,n=i.modifierId,o=(e.minAmount,e.maxAmount,this.modifiers.indexById[r]||{}),s=o.maxAmount,d=void 0===s?0:s,a=this.modifiersValueTree[r][n],c=a?0:1;this.twoPartsAssembledModifiersIdsByGroupId[r]||(this.twoPartsAssembledModifiersIdsByGroupId[r]=[]);var l=this.modifiers.indexById[r].totalAmount-a+c;if(d<l){if(!this.twoPartsAssembledModifiersIdsByGroupId[r].length)return console.warn("Limit: max "+d+". Current "+l),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[r].group.name+'" - не более '+d));for(var m in this.modifiersValueTree[r])this.modifiersValueTree[r][m]=0;this.twoPartsAssembledModifiersIdsByGroupId[r]=this.twoPartsAssembledModifiersIdsByGroupId[r].slice(1,2),this.modifiersValueTree[r][this.twoPartsAssembledModifiersIdsByGroupId[r][0]]=1}else 0==l&&(this.twoPartsAssembledModifiersIdsByGroupId[r]=[]);c&&!this.twoPartsAssembledModifiersIdsByGroupId[r].find(function(e){return e==n})&&this.twoPartsAssembledModifiersIdsByGroupId[r].push(n),this.modifiersValueTree[r][n]=c,this.calculateTotalAmountInGroup(r),this.calculateTotalPrice()},r.prototype.changeModifierAmount=function(e,i,t){if(!(i<0)){var r=this.getModifiersIds(e),n=r.groupId,o=void 0===n?"single":n,s=r.modifierId,d=e.minAmount,a=e.maxAmount,c=this.modifiers.indexById[o]||{},l=c.minAmount,m=void 0===l?0:l,h=c.maxAmount,p=void 0===h?0:h,u=this.modifiersValueTree[o][s];if("checkbox"==t&&"single"!==o){if(m<=1&&1==p){if(i<m)return;for(var f in this.modifiersValueTree[o])this.modifiersValueTree[o][f]=0;this.calculateTotalAmountInGroup(o)}if(0==i)return void this.calculateTotalPrice()}if(m||p){var g=this.modifiers.indexById[o].totalAmount-u+i;if(g<m)return console.warn("Limit: min "+m+". Current "+g),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[o].group.name+'" - не менее '+m));if(p<g)return console.warn("Limit: max "+p+". Current "+g),void this.eventer.emitMessageEvent(new v.EventMessage("warning","Ограничение",'Максимальное количество опций для группы\n            модификаторов "'+this.modifiers.indexById[o].group.name+'" - не более '+p))}if(d||a){if(i<d)switch(t){case"plus":i=d;break;case"minus":i=0}a<i&&(i=a)}this.modifiersValueTree[o][s]=i,this.calculateTotalAmountInGroup(o),this.calculateTotalPrice()}},r.prototype.setModifiers=function(){var e,i=[];for(e in this.modifiersValueTree)for(var t in this.modifiersValueTree[e]){var r=this.modifiersValueTree[e][t];r&&i.push({id:t,amount:r,groupId:"single"!==e?e:undefined})}i.length&&(this.checkValid(),this.cartService.setModifires(i,[]))},r.prototype.checkValid=function(){var e,i=!0;for(e in this.modifiersValueTree){var t,r=this.modifiers.indexById[e];r.required&&((t=this.calculateTotalAmountInGroup(e))<r.minAmount&&(i=!1,console.warn("Modifier "+e+" min amount: "+r.minAmount)),t>r.maxAmount&&(i=!1,console.warn("Modifier "+e+" max amount: "+r.maxAmount)))}this.validate.emit(i)},r.decorators=[{type:d.Component,args:[{selector:"dish-calc-ln",template:'<div *ngIf="dish" class="ng-cart-dish-calc" [ngClass]="{\'ng-cart-dish-calc-two-parts-assembled\': isTwoPartsAssembledTemplate}">\n    <div class="title-box">{{ dish.name }}</div>\n    <div class="view-box">\n\n        <ng-container *ngIf="isTwoPartsAssembledTemplate; then twoPartsAssembledHeaderTemplate else baseHeaderTemplate"></ng-container>\n        <ng-template #baseHeaderTemplate>\n            <div class="dish">\n                <div class="dish-image-box">\n                    <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n                </div>\n                <div class="dish-description-box">\n                    <div class="dish-ingredients">{{ dish.description }}</div>\n                    <div class="dish-price-box">\n                        <ng-container *ngIf="modifiers.custom.fixed as modifier">\n                            <div class="modifier-fixed">\n                                <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                    <div class="item"\n                                         [ngClass]="{selected: !!modifiersValueTree[modifier.modifierId][childModifier.modifierId]}"\n                                         (click)="changeModifierAmount(childModifier, 1, \'checkbox\')">\n                                        {{ childModifier.dish?.name }}\n                                    </div>\n                                </ng-container>\n                            </div>\n                            <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                <ng-container *ngIf="!!modifiersValueTree[modifier.modifierId][childModifier.modifierId]">\n                                    <div class="price" [ngClass]="{\'zero-price\': !childModifier.dish?.price}">\n                                        <span>{{ childModifier.dish?.price }}</span> ₽\n                                    </div>\n                                </ng-container>\n                            </ng-container>\n                        </ng-container>\n                    </div>\n                </div>\n            </div>\n        </ng-template>\n        <ng-template #twoPartsAssembledHeaderTemplate>\n            <ng-container *ngFor="let modifier of modifiers.baseList">\n                <ng-container *ngIf="modifier.childModifiers?.length && modifier.minAmount == 2 && modifier.maxAmount == 2">\n                    <div class="two-parts-assembled-header" [ngClass]="{empty: !twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId]?.length}">\n                        <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                            <ng-container *ngIf="modifiersValueTree[modifier.modifierId][childModifier.modifierId]">\n                                <ng-container *ngIf="childModifier.dish as dish">\n                                    <div class="selected-dish">\n                                        \x3c!--<div class="title">{{ dish.name }}</div>--\x3e\n                                        <div class="image-box">\n                                            <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n                                        </div>\n                                    </div>\n                                </ng-container>\n                                <ng-container *ngIf="modifiers.indexById[modifier.modifierId].totalAmount == 1">\n                                    <div class="selected-dish">\n                                        \x3c!--<div class="title">Выберите половину</div>--\x3e\n                                        <div class="image-box">\n                                            <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: {} }"></ng-container>\n                                        </div>\n                                    </div>\n                                </ng-container>\n                            </ng-container>\n                        </ng-container>\n                    </div>\n                    <div class="two-parts-assembled-selected-dishes-names" >\n                        \x3c!--twoPartsAssembledModifiersIdsByGroupId: {{ twoPartsAssembledModifiersIdsByGroupId | json }}<br>\n                        modifier.modifierId: {{ modifier.modifierId }}<br>--\x3e\n\n                        <div class="selected-dish-item">\n                            <div class="type-name">Левая:</div>\n                            <div class="dish-name" *ngIf="twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId] && twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId][0]; else noDishTemplate">\n                                {{ modifiers.indexById[twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId][0]].dish?.name }}\n                            </div>\n                        </div>\n                        <div class="selected-dish-item">\n                            <div class="type-name">Правая:</div>\n                            <div class="dish-name" *ngIf="twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId] && twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId][1]; else noDishTemplate">\n                                {{ modifiers.indexById[twoPartsAssembledModifiersIdsByGroupId[modifier.modifierId][1]].dish?.name }}\n                            </div>\n                        </div>\n                        <ng-template #noDishTemplate>\n                            <div class="dish-name empty">Не выбрана</div>\n                        </ng-template>\n                    </div>\n                </ng-container>\n            </ng-container>\n        </ng-template>\n\n        <div class="comment" *ngIf="isTwoPartsAssembledTemplate">\n            <div class="divider"></div>\n            <div class="title">Комментарий</div>\n            <div class="input-box">\n                <input #commentInput type="text" placeholder="" (keyup)="comment.emit(commentInput.value)">\n            </div>\n        </div>\n    </div>\n\n\n    <div class="settings-box">\n        <div class="modifiers" *ngIf="modifiers.baseList?.length">\n            <ng-container *ngFor="let modifier of modifiers.baseList">\n                <div class="modifier-group">\n                    <ng-container *ngIf="modifier.dish">\n                        <div class="modifier-header" *ngIf="modifier.group as group">\n                            <div class="modifier-name" *ngIf="group.name">{{ group.name }}</div>\n                            <div class="modifier-description" *ngIf="group.description">{{ group.description }}</div>\n                        </div>\n\n                        <div class="modifier-box" [ngClass]="{\'without-images\': !modifier.childImagesIsset}">\n                            \x3c!-- Single modifier --\x3e\n                            <ng-container *ngTemplateOutlet="modifierTemplate; context: {\n                            modifier: modifier,\n                            groupId: \'single\',\n                            amount: modifiersValueTree[\'single\'][modifier.modifierId],\n                            groupAmount: modifiersValueTree[\'single\'][modifier.modifierId],\n                            groupMinAmount: modifier.minAmount || 0,\n                            groupMaxAmount: modifier.maxAmount || 100\n                        }"></ng-container>\n                        </div>\n                    </ng-container>\n\n                    <ng-container *ngIf="modifier.childModifiers?.length">\n                        <ng-container *ngIf="modifier.minAmount == 2 && modifier.maxAmount == 2; then twoPartsAssembledTemplate else groupTemplate">\n                        </ng-container>\n\n                        \x3c!-- Base group modifier view --\x3e\n                        <ng-template #groupTemplate>\n                            <div class="modifier-header" *ngIf="modifier.group as group">\n                                <div class="modifier-name" *ngIf="group.name">{{ group.name }}</div>\n                                <div class="modifier-description" *ngIf="group.description">{{ group.description }}</div>\n                            </div>\n                            <div class="modifier-children" [ngClass]="{\'without-images\': !modifier.imagesIsset}">\n                                <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                    \x3c!-- Group modifier --\x3e\n                                    <ng-container *ngTemplateOutlet="modifierTemplate; context: {\n                            modifier: childModifier,\n                            groupId: modifier.modifierId,\n                            amount: modifiersValueTree[modifier.modifierId][childModifier.modifierId],\n                            groupAmount: modifiers.indexById[modifier.modifierId].totalAmount,\n                            groupMinAmount: modifier.minAmount || 0,\n                            groupMaxAmount: modifier.maxAmount || 100\n                        }"></ng-container>\n\n                                </ng-container>\n                            </div>\n                        </ng-template>\n\n                        \x3c!-- Two parts assembled group modifier view (like pizza from two halves) --\x3e\n                        <ng-template #twoPartsAssembledTemplate>\n                            <div class="two-parts-assembled">\n                                <div class="two-parts-assembled-body">\n                                    <div class="two-parts-assembled-body-name">Выберите любые две половинки</div>\n                                    <div class="two-parts-assembled-body-list">\n                                        <ng-container *ngFor="let childModifier of modifier.childModifiers">\n                                            <div class="two-parts-assembled-body-list-dish"\n                                                 (click)="selectTwoPartsAssembledModifier(childModifier)"\n                                                 [ngClass]="{selected: modifiersValueTree[modifier.modifierId][childModifier.modifierId]}"\n                                                 *ngIf="childModifier.dish as dish">\n                                                <div class="image-box">\n                                                    <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n                                                </div>\n                                                <div class="dish-name">\n                                                    {{ dish.name }}\n                                                </div>\n                                                <div class="dish-price">\n                                                    <div [ngClass]="{\'zero-price\': !dish.price}">\n                                                        <span>{{ dish.price }}</span> ₽\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </ng-container>\n                                    </div>\n                                </div>\n                            </div>\n                        </ng-template>\n\n\n                    </ng-container>\n\n                </div>\n            </ng-container>\n        </div>\n    </div>\n\n\n    <div class="result-box result">\n        <span class="text">ИТОГО:</span>\n        <span class="price">\n            <span>{{ totalPrice}}</span> ₽\n        </span>\n    </div>\n\n\n</div>\n\n\n\n\x3c!-- Template block #dishImageTemplate --\x3e\n\n<ng-template #dishImageTemplate let-dish="dish">\n    <ng-container *ngIf="dish?.images && dish.images[0]?.images?.small; else imgPlaceholder">\n        <div class="dish-image" [style.backgroundImage]="\'url(\' + imageUrl + dish.images[0].images.small + \')\'"></div>\n    </ng-container>\n    <ng-template #imgPlaceholder>\n        <div class="dish-image-placeholder"></div>\n    </ng-template>\n</ng-template>\n\n\x3c!-- Template block #modifierTemplate --\x3e\n\n<ng-template #modifierTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount"\n             let-groupAmount="groupAmount"\n             let-groupMinAmount="groupMinAmount"\n             let-groupMaxAmount="groupMaxAmount">\n    <ng-container *ngIf="modifier.dish as dish">\n        <div class="modifier-dish">\n            <div class="modifier-dish-image-box">\n                <ng-container *ngTemplateOutlet="dishImageTemplate; context: { dish: dish }"></ng-container>\n            </div>\n            <div class="modifier-dish-description-box">\n                <div class="modifier-dish-name">{{ dish.name }}</div>\n                <div class="modifier-dish-weight" *ngIf="dish.weight">{{ dish.weight * 1000 }} гр</div>\n            </div>\n            <div class="modifier-dish-price-box">\n                <div [ngClass]="{\'zero-price\': !dish.price}">\n                    <span>{{ dish.price }}</span> ₽\n                </div>\n            </div>\n            <div class="modifier-dish-action-box">\n                <ng-container *ngIf="groupMinAmount <= 1 && groupMaxAmount == 1; else counterTemplate">\n                    <ng-container *ngTemplateOutlet="modifierCheckboxTemplate; context: {\n                        modifier: modifier,\n                        groupId: groupId,\n                        amount: amount\n                    }"></ng-container>\n                </ng-container>\n\n                <ng-template #counterTemplate>\n                    <ng-container *ngTemplateOutlet="modifierCounterTemplate; context: {\n                        modifier: modifier,\n                        groupId: groupId,\n                        amount: amount,\n                        groupAmount: groupAmount,\n                        groupMinAmount: groupMinAmount,\n                        groupMaxAmount: groupMaxAmount\n                    }"></ng-container>\n                </ng-template>\n\n            </div>\n        </div>\n    </ng-container>\n</ng-template>\n\n\x3c!-- Template block #modifierCounterTemplate --\x3e\n\n<ng-template #modifierCounterTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount"\n             let-groupAmount="groupAmount"\n             let-groupMinAmount="groupMinAmount"\n             let-groupMaxAmount="groupMaxAmount">\n    <ng-container>\n        <div class="modifier-counter" [ngClass]="{disabled: !amount && groupAmount >= groupMaxAmount}">\n            <div\n                    class="minus"\n                    [ngClass]="{disabled: !amount || groupAmount <= groupMinAmount}"\n                    (click)="changeModifierAmount(modifier, amount - 1, \'minus\')"\n                    onselectstart="return false;">-</div>\n            <input [value]="amount" readonly #input>\n            <div\n                    class="plus"\n                    [ngClass]="{disabled: groupAmount >= groupMaxAmount}"\n                    (click)="changeModifierAmount(modifier, amount + 1, \'plus\')"\n                    onselectstart="return false;">+</div>\n        </div>\n    </ng-container>\n</ng-template>\n\n\x3c!-- Template block #modifierCheckboxTemplate --\x3e\n\n<ng-template #modifierCheckboxTemplate\n             let-modifier="modifier"\n             let-groupId="groupId"\n             let-amount="amount">\n    <ng-container>\n        <div\n                class="modifier-checkbox"\n                [ngClass]="{selected: amount}"\n                (click)="changeModifierAmount(modifier, amount ? 0 : 1, \'checkbox\')"></div>\n    </ng-container>\n</ng-template>\n',styles:["@charset \"UTF-8\";.title-box{font-size:22px;line-height:25px;letter-spacing:2.4px;font-weight:700;color:#0a0909;text-transform:uppercase;position:fixed;width:calc(100% - 200px);margin-top:-70px;margin-left:40px;text-align:center}.view-box{position:fixed;width:300px;min-height:calc(100% - 280px);border-right:1px solid #e9e7e7;box-sizing:border-box;padding-right:20px}.settings-box{padding-left:320px}.dish .dish-image-box{position:relative;width:250px;height:170px;box-sizing:border-box;text-align:center;background-color:#eee;background-size:50%}.dish .dish-description-box{height:170px;display:flex;flex-direction:column;align-items:stretch;padding:5px 0 0;box-sizing:border-box}.dish .dish-description-box .dish-name{font-weight:700;font-size:28px;line-height:32px;letter-spacing:2.4px;color:#0a0909}.dish .dish-description-box .dish-ingredients{font-size:15px;font-weight:500;line-height:17px;color:#000;margin-top:15px;overflow:hidden;flex-grow:1}.dish .dish-description-box .dish-price-box{font-weight:700;font-size:20px;line-height:23px;display:flex;align-items:center;justify-content:space-between;height:45px;margin-right:49px}.ng-cart-dish-calc-two-parts-assembled .dish{border:none;margin-left:0;padding-bottom:0}.ng-cart-dish-calc-two-parts-assembled .dish .dish-image-box{display:none}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box{width:100%;height:auto}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-name{text-align:center;font-weight:700;font-size:28px;line-height:32px;letter-spacing:2.4px;color:#0a0909;text-transform:uppercase}.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-ingredients,.ng-cart-dish-calc-two-parts-assembled .dish .dish-description-box .dish-price-box{display:none}.dish-image{width:250px;height:100%;border-radius:0;background-size:cover;background-position:top;background-repeat:no-repeat}.result{margin-top:49px;font-weight:700;font-size:24px;line-height:28px;color:#0a0909;text-align:right}.result .price{margin-left:76px}.comment{padding-bottom:15px;border-top:1px solid #e9e7e7;margin-top:30px}.comment .title{font-weight:500;font-size:18px;line-height:20px;color:#0a0909;margin:30px 0 15px}.comment .input-box{margin-top:10px}.comment .input-box input{border:2px solid #969696;box-sizing:border-box;border-radius:10px;height:35px;line-height:35px;font-style:italic;font-weight:400;font-size:16px;color:#969696;padding:0 20px}.modifiers .modifier-group{margin-top:25px;padding-bottom:25px}.modifiers .modifier-header{margin-bottom:25px}.modifiers .modifier-header .modifier-name{font-weight:500;font-size:20px;line-height:23px;color:#0a0909;padding-bottom:12px;text-align:center;border-bottom:1px solid #000;margin:0 100px}.modifiers .modifier-header .modifier-description{font-size:15px;line-height:17px;color:#0a0909}.modifiers .modifier-dish{display:flex;justify-content:center;align-items:center;margin-bottom:2px;height:100px;box-sizing:border-box}.modifiers .modifier-dish .modifier-dish-image-box{position:relative;width:70px;height:70px;box-sizing:border-box;text-align:center;background-color:#fff;background-size:50%;margin-right:28px}.modifiers .modifier-dish .modifier-dish-image-box .dish-image{width:100%;height:100%;background-size:contain;background-position:center}.modifiers .modifier-dish .modifier-dish-description-box{flex-grow:1;display:flex;flex-direction:column;justify-content:center}.modifiers .modifier-dish .modifier-dish-description-box .modifier-dish-name{font-weight:500;font-size:16px;line-height:23px;color:#0a0909}.modifiers .modifier-dish .modifier-dish-description-box .modifier-dish-weight{font-size:16px;line-height:23px;color:#0a0909;margin-top:0}.modifiers .modifier-dish .modifier-dish-price-box{font-weight:700;font-size:16px;line-height:23px;color:#0a0909;margin-right:105px}.modifiers .modifier-dish .modifier-dish-price-box .zero-price{display:none}.modifiers .modifier-dish .modifier-dish-action-box{width:102px;display:flex;justify-content:flex-end}.two-parts-assembled-header{display:flex;align-items:center;justify-content:center;padding-bottom:28px;opacity:1;height:230px;overflow:hidden;transition:.5s}.two-parts-assembled-header.empty{border-bottom:none;height:0;opacity:0}.two-parts-assembled-header .selected-dish{display:flex;align-items:center;justify-content:flex-end;width:50%}.two-parts-assembled-header .selected-dish .image-box{width:113px;height:226px;overflow:hidden}.two-parts-assembled-header .selected-dish .image-box .dish-image{width:200%;height:100%}.two-parts-assembled-header .selected-dish:nth-child(2){flex-direction:row-reverse}.two-parts-assembled-header .selected-dish:nth-child(2) .image-box{direction:rtl}.two-parts-assembled-selected-dishes-names .selected-dish-item{display:flex}.two-parts-assembled-selected-dishes-names .selected-dish-item:first-child{margin-bottom:12px}.two-parts-assembled-selected-dishes-names .selected-dish-item .type-name{width:70px;font-weight:500;font-size:16px;color:#0a0909;content:'Левая:'}.two-parts-assembled-selected-dishes-names .selected-dish-item .type-name:last-child{content:'Правая:'}.two-parts-assembled-selected-dishes-names .selected-dish-item .dish-name{font-size:16px;color:#0a0909}.two-parts-assembled-selected-dishes-names .selected-dish-item .dish-name.empty{font-style:italic;font-weight:400;font-size:16px;color:#969696}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-name{font-weight:500;font-size:20px;line-height:23px;color:#0a0909;padding:20px 0}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list{display:grid;grid-template-columns:1fr 1fr 1fr;margin-top:30px;grid-column-gap:30px;grid-row-gap:24px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish{display:flex;flex-direction:column;align-items:center;box-sizing:border-box;cursor:pointer;color:#0a0909;border:1.5px solid rgba(255,255,255,0)}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish.selected{border:1.5px solid #0a0909;border-radius:15px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .dish-name{font-weight:500;font-size:12px;line-height:12px;letter-spacing:2.4px;text-transform:uppercase;text-align:center;padding:0 5px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .dish-price{font-weight:700;font-size:12px;line-height:15px;padding:5px 0 10px}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .image-box{width:168px;height:168px;border-radius:15px 15px 0 0}.two-parts-assembled .two-parts-assembled-body .two-parts-assembled-body-list .two-parts-assembled-body-list-dish .image-box .dish-image{width:100%;height:100%;border-radius:15px 15px 0 0}.modifier-fixed{border:2px solid #767676;box-sizing:border-box;border-radius:15px;display:flex;align-items:stretch;height:45px}.modifier-fixed .item{font-weight:500;font-size:20px;line-height:23px;width:142px;height:45px;color:#767676;display:flex;align-items:center;justify-content:center;margin-top:-2px}.modifier-fixed .item:first-child{margin-left:-2px}.modifier-fixed .item:last-child{margin-right:-2px}.modifier-fixed .item.selected{background:#0a0909;border-radius:15px;color:#fff}.modifier-fixed .item:not(.selected){cursor:pointer}.modifier-checkbox{width:50px;height:50px;background:#e0e0e0;border-radius:15px;cursor:pointer;display:flex;justify-content:center;align-items:center}.modifier-checkbox.selected:after{content:url(\"data:image/svg+xml; base64, PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIgMTMuNUwxMS4zMjMxIDI2TDI2IDIiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMy41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+Cg==\")}.modifier-counter{display:flex;align-items:center;position:relative;border:none;width:102px;height:35px;border-radius:10px;background:#e0e0e0}.modifier-counter.disabled{opacity:.3}.modifier-counter:not(.disabled) .minus.disabled,.modifier-counter:not(.disabled) .plus.disabled{opacity:.15;cursor:default}.modifier-counter input{border:none;background:0 0;width:100%;padding:0;height:35px;line-height:35px;text-align:center;font-weight:500;font-size:18px;color:#0a0909}.modifier-counter .minus,.modifier-counter .plus{display:block;position:absolute;top:0;height:35px;line-height:35px;text-align:center;font-style:normal;font-weight:700;font-size:18px;color:#0a0909;padding:0 13px;cursor:pointer}.modifier-counter .minus:hover,.modifier-counter .plus:hover{color:#000}.modifier-counter .minus:active,.modifier-counter .plus:active{color:#cc0009}.modifier-counter .minus.loading,.modifier-counter .plus.loading{opacity:.2}.modifier-counter .minus{left:0}.modifier-counter .plus{right:0}.without-images .modifier-dish-image-box{display:none}.without-images .modifier-dish{height:70px}"]}]}],r.ctorParameters=function(){return[{type:c.NgRestoCartService},{type:v.EventerService},{type:String,decorators:[{type:d.Inject,args:["ImageUrl"]}]}]},r.propDecorators={dish:[{type:d.Input}],amount:[{type:d.Input}],selectedModifiers:[{type:d.Input}],validate:[{type:d.Output}],amountDishToAdd:[{type:d.Output}],comment:[{type:d.Output}]},r);function r(e,i,t){this.cartService=e,this.eventer=i,this.validate=new d.EventEmitter,this.amountDishToAdd=new d.EventEmitter,this.comment=new d.EventEmitter,this.modifiers={indexById:{},custom:{fixed:null},baseList:[]},this.modifiersValueTree={},this.twoPartsAssembledModifiersIdsByGroupId={},this.imageUrl=t}i.DishCalcLnComponent=t});e.unwrapExports($);$.DishCalcLnComponent;var X=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var t=[h.AddDishToCartDirective,p.AmountCartDirective,u.DeleteFromCartDirective,f.OrderCartUserDirective,x.DishCalcDirective,y.SetDishCommentDirective,g.SetAmountDirective,b.CheckoutDirective],r=[I.DishCalcComponent,w.DishCalcLnComponent],n=[m.CommonModule],o=(s.decorators=[{type:d.NgModule,args:[{imports:[n],providers:[],declarations:[t,r],exports:[t,r]}]}],s);function s(){}i.NgRestoCartModule=o});e.unwrapExports(X);X.NgRestoCartModule;var ee=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),F.__exportStar(M,i),F.__exportStar(C,i)});e.unwrapExports(ee);var ie=e.createCommonjsModule(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),F.__exportStar(T,i),i.ɵj=A.DishCalcLnComponent,i.ɵi=P.DishCalcComponent,i.ɵa=D.AddDishToCartDirective,i.ɵb=k.AmountCartDirective,i.ɵh=j.CheckoutDirective,i.ɵc=O.DeleteFromCartDirective,i.ɵe=E.DishCalcDirective,i.ɵd=S.OrderCartUserDirective,i.ɵg=_.SetAmountDirective,i.ɵf=B.SetDishCommentDirective});return e.unwrapExports(ie)});
//# sourceMappingURL=webresto-ng-cart.umd.min.js.map